
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>2.1. Road towards Anticipatory Learning Classifier Systems &#8212; Real-valued Anticipatory Classifier System</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="2.2. Real-valued signal challenge" href="23_real_value_challenge.html" />
    <link rel="prev" title="2. Selected topics of Learning Classifier Systems" href="21_introduction.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/pwr_logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Real-valued Anticipatory Classifier System</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Real-valued Anticipatory Classifier System
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_introduction/11_introduction.html">
   1. Introduction
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_introduction/12_motivation.html">
     1.1. Motivation and challenges
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_introduction/13_aims_goals.html">
     1.2. Research hypothesis, its aims and goals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_introduction/14_structure.html">
     1.3. Thesis structure
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="21_introduction.html">
   2. Selected topics of Learning Classifier Systems
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     2.1. Road towards Anticipatory Learning Classifier Systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="23_real_value_challenge.html">
     2.2. Real-valued signal challenge
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="24_kpi.html">
     2.3. Key performance indicators
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="25_stats.html">
     2.4. Statistical verification of results
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="26_envs.html">
     2.5. Overview of the selected environments
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_internalizing/31_introduction.html">
   3. Ways of handling real-valued input signal
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../3_internalizing/interval/32_interval_based_representation.html">
     3.1. Interval-based representation
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../3_internalizing/interval/32_experiment_1.html">
       Experiment 1 - Encoding precision
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../3_internalizing/interval/32_experiment_2.html">
       Experiment 2 - Nature of the intervals
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../3_internalizing/discretization/33_discretizing_input_signal.html">
     3.2. Discretizing input signal
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../3_internalizing/discretization/33_experiment_3.html">
       Experiment 3 - Single step
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../3_internalizing/discretization/33_experiment_4.html">
       Experiment 4 - Multistep environments
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_biased_exploration/41_introduction.html">
   4. Optimizing formation of internal model
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../4_biased_exploration/41_biased_exploration.html">
     4.1. Biased exploration
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
    <label for="toctree-checkbox-7">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../4_biased_exploration/41_experiment_1.html">
       Experiment 1 - Multi-steps problems performance
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../4_biased_exploration/41_experiment_2.html">
       Experiment 2 - Single-step problem performance
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../4_biased_exploration/41_experiment_3.html">
       Experiment 3 - Balacing the pole
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_diminishing_reward/51_introduction.html">
   5. Optimizing distributing reward through long action chains
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../5_diminishing_reward/51_diminishing_reward.html">
     5.1. Diminishing reward
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
    <label for="toctree-checkbox-9">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../5_diminishing_reward/51_experiment_1.html">
       Experiment 1 - Corridor environment
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../5_diminishing_reward/51_experiment_2.html">
       Experiment 2 - Finite-State-World environment
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../5_diminishing_reward/51_experiment_3.html">
       Experiment 3 - Woods1 environment
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../6_summary/61_summary.html">
   6. Summary
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../abbreviations.html">
   7. Abbreviations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../bibliography.html">
   8. Bibliography
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/chapters/2_selected_topics/22_alcs_history.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/khozzy/phd"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/khozzy/phd/issues/new?title=Issue%20on%20page%20%2Fchapters/2_selected_topics/22_alcs_history.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/khozzy/phd/gh-pages?urlpath=tree/chapters/2_selected_topics/22_alcs_history.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#selected-topics-of-lcs">
   Selected topics of LCS
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rules-and-classifiers">
     Rules and Classifiers
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#driving-mechanisms">
     Driving Mechanisms
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#functional-cycle">
     Functional cycle
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pittsburgh-vs-michigan">
     Pittsburgh vs Michigan
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#representative-lcs">
   Representative LCS
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cs-1">
     CS-1
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#zcs">
     ZCS
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#xcs">
     XCS
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#anticipatory-learning-classifier-systems">
   Anticipatory Learning Classifier Systems
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#acs2">
     ACS2
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#macs">
     MACS
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Road towards Anticipatory Learning Classifier Systems</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#selected-topics-of-lcs">
   Selected topics of LCS
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rules-and-classifiers">
     Rules and Classifiers
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#driving-mechanisms">
     Driving Mechanisms
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#functional-cycle">
     Functional cycle
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pittsburgh-vs-michigan">
     Pittsburgh vs Michigan
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#representative-lcs">
   Representative LCS
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cs-1">
     CS-1
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#zcs">
     ZCS
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#xcs">
     XCS
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#anticipatory-learning-classifier-systems">
   Anticipatory Learning Classifier Systems
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#acs2">
     ACS2
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#macs">
     MACS
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gym</span>
<span class="kn">import</span> <span class="nn">gym_maze</span>  <span class="c1"># noqa: F401</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">pathlib</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">groupby</span>

<span class="kn">from</span> <span class="nn">src.decorators</span> <span class="kn">import</span> <span class="n">get_from_cache_or_run</span>
<span class="kn">from</span> <span class="nn">lcs</span> <span class="kn">import</span> <span class="n">Perception</span>

<span class="kn">from</span> <span class="nn">src.visualization</span> <span class="kn">import</span> <span class="n">PLOT_DPI</span>
<span class="kn">from</span> <span class="nn">src.utils</span> <span class="kn">import</span> <span class="n">build_plots_dir_path</span><span class="p">,</span> <span class="n">build_cache_dir_path</span>

<span class="n">root_dir</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">()</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span>
<span class="n">cwd_dir_name</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">()</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span><span class="o">.</span><span class="n">name</span>

<span class="n">plot_dir</span> <span class="o">=</span> <span class="n">build_plots_dir_path</span><span class="p">(</span><span class="n">root_dir</span><span class="p">)</span> <span class="o">/</span> <span class="n">cwd_dir_name</span>
<span class="n">cache_dir</span> <span class="o">=</span> <span class="n">build_cache_dir_path</span><span class="p">(</span><span class="n">root_dir</span><span class="p">)</span> <span class="o">/</span> <span class="n">cwd_dir_name</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ioff</span><span class="p">();</span>  <span class="c1"># turn off interactive plotting</span>
</pre></div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="road-towards-anticipatory-learning-classifier-systems">
<h1><span class="section-number">2.1. </span>Road towards Anticipatory Learning Classifier Systems<a class="headerlink" href="#road-towards-anticipatory-learning-classifier-systems" title="Permalink to this headline">¶</a></h1>
<p>The concept of LCS was introduced by John Holland in 1975 <span id="id1">[<a class="reference internal" href="../../bibliography.html#id48">25</a>]</span> in order to model the idea of cognition based on adaptive mechanisms. From the early days they consist of a set of rules named <em>classifiers</em>  combined with mechanisms in charge of evolving them. Initially the goal was to handle problems related to online interaction with external environments, as described by Wilson in <span id="id2">[<a class="reference internal" href="../../bibliography.html#id49">26</a>]</span>.</p>
<p>To accomplish this, the emphasis was put on parallelism in the architecture and evolutionary mechanisms allowing the agent to adapt to potentially changing environment <span id="id3">[<a class="reference internal" href="../../bibliography.html#id50">27</a>]</span>. This approach was referenced as <em>“escaping brittleness”</em> <span id="id4">[<a class="reference internal" href="../../bibliography.html#id51">28</a>]</span> due to the problems related to the lack of robustness of the current artificial intelligence systems.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition-john-henry-holland admonition">
<p class="admonition-title">John Henry Holland</p>
<img alt="../../_images/John_Holland.jpg" src="../../_images/John_Holland.jpg" />
<p><a class="reference external" href="https://en.wikipedia.org/wiki/John_Henry_Holland">John H. Holland</a> is best known for his role as a founding father of the complex systems approach. In particular, he developed genetic algorithms and learning classifier systems.</p>
<p>These foundational building blocks of an evolutionary approach to optimization are now included in all texts on optimization and programming.</p>
</div>
</div>
<p>The naming convention used to refer to the LCS algorithm also changed since its infancy. Holland initially called it as a classifier system, abbreviated either as (CS) or (CFS) <span id="id5">[<a class="reference internal" href="../../bibliography.html#id52">29</a>]</span>. From that time it was also referred to as adaptive agents <span id="id6">[<a class="reference internal" href="../../bibliography.html#id53">30</a>]</span>, cognitive systems <span id="id7">[<a class="reference internal" href="../../bibliography.html#id22">2</a>]</span> and genetic-based machine learning <span id="id8">[<a class="reference internal" href="../../bibliography.html#id24">3</a>]</span> <span id="id9">[<a class="reference internal" href="../../bibliography.html#id54">31</a>]</span>. The current name of LCS was not adopted until the late 80s <span id="id10">[<a class="reference internal" href="../../bibliography.html#id55">32</a>]</span> after extending the architecture with a credit assignment component <span id="id11">[<a class="reference internal" href="../../bibliography.html#id51">28</a>]</span> <span id="id12">[<a class="reference internal" href="../../bibliography.html#id56">33</a>]</span>.</p>
<p>This section provides a synopsis of crucial LCS concepts alongside the most popular variants, and the contributions they made to the field.</p>
<div class="section" id="selected-topics-of-lcs">
<h2>Selected topics of LCS<a class="headerlink" href="#selected-topics-of-lcs" title="Permalink to this headline">¶</a></h2>
<div class="section" id="rules-and-classifiers">
<h3>Rules and Classifiers<a class="headerlink" href="#rules-and-classifiers" title="Permalink to this headline">¶</a></h3>
<p>In general form, LCS utilizes <em>rules</em> as a fundamental block of modeling knowledge. It comprises a <em>condition</em> (i.e. specified feature states), and an <em>action</em> (also referred to as the class). They can be interpreted using the “IF condition THEN action” logical expression. When the condition part is expressed with either boolean or nominal representation the generalization property using the “don’t care” symbol # is possible. Two input situations are considered equivalent with respect to a given classifier if the specified (non-#) values in the condition match the corresponding attributes of the two situations</p>
<p>In addition to condition and action, a rule typically has a number of algorithm related parameter values associated with it (like its performance or expected reward). The term <em>classifier</em> is used to describe a rule along with it associated parameters.</p>
<p>It is important to realise that LCS comprise a population of single rules, that collaboratively seek to cover the problem space. The number of classifiers needed to solve the particular problem depends on a number of factors like problem complexity or rule representation used.</p>
</div>
<div class="section" id="driving-mechanisms">
<h3>Driving Mechanisms<a class="headerlink" href="#driving-mechanisms" title="Permalink to this headline">¶</a></h3>
<p>There are two fundamental components behind every LCS algorithm - the discovery and learning (credit assignment) component. Both of them have generated respective fields of study, but it is in the context of LCS that we wish to understand their function and purpose.</p>
<p><strong>Discovery component</strong></p>
<p>The discovery component is responsible for exploring the search space of the target problem with the purpose of discovering new rules. A vast majority of LCS algorithms employ some form of Evolutionary Computation, most often Genetic Algorithm (GA), employing Neo-Darwinist theory of natural selection <span id="id13">[<a class="reference internal" href="../../bibliography.html#id57">34</a>]</span> <span id="id14">[<a class="reference internal" href="../../bibliography.html#id54">31</a>]</span>. The evolution of rules is modeled after the evolution of organisms using following biological analogies:</p>
<ol class="simple">
<li><p>a code is used to represent the genotype/genome (condition),</p></li>
<li><p>a solution (phenotype) representation is associated with that genome (action),</p></li>
<li><p>a phenotype selection process (survival of the fittest) - the fittest organism (rule) has the greatest chances of reproducing and passing parts of its genome to offsprings,</p></li>
<li><p>certain genetic genome operators are utilized in order to chase after fitter organisms (rules) <span id="id15">[<a class="reference internal" href="../../bibliography.html#id45">35</a>]</span> <span id="id16">[<a class="reference internal" href="../../bibliography.html#id58">36</a>]</span>.</p></li>
</ol>
<p>Two genetic operators are typically used to alternate genome (rule) - mutation and crossover (recombination). The first one randomly modify an element in a genotype of an individual (rule), while the latter one recombine parts of two promising genotypes (rules) creating a new one. The selection pressure driving better organisms (rules) to reproduce more frequently depends on the fitness function. The fitness function quantifies the optimality of given rule, allowing it to be ranked across all rules in entire population.</p>
<p>GA implementation varies in certain LCS, but the overall scheme involves evaluating all available rules, selecting most promising offsprings (according to fitness value), applying genetic operators, introducing new offspring back to population set and finally removing excess or under-performing individuals.</p>
<p><strong>Learning component</strong></p>
<p>As mentioned earlier each classifier is accompanied by certain parameter values. The iterative update of them drives the process of LCS reinforcement by distributing any incoming reward signal to the classifiers that are accountable for it. This process serves two purposes:</p>
<ol class="simple">
<li><p>identification of classifiers responsible for obtaining large future rewards,</p></li>
<li><p>encourage the discoverability of new rules (by directly affecting the fitness value)</p></li>
</ol>
<p>The learning strategy depends on the nature of the problem and is realized differently in LCS implementations. In all cases, however the process is performed through trial-and-error interactions with the environment, where occasional immediate reward is used to generate the policy (state-action mapping of agent-environment interactions) maximizing long-term reward <span id="id17">[<a class="reference internal" href="../../bibliography.html#id29">37</a>]</span> <span id="id18">[<a class="reference internal" href="../../bibliography.html#id59">38</a>]</span> <span id="id19">[<a class="reference internal" href="../../bibliography.html#id60">39</a>]</span>.</p>
</div>
<div class="section" id="functional-cycle">
<h3>Functional cycle<a class="headerlink" href="#functional-cycle" title="Permalink to this headline">¶</a></h3>
<p>The agent interacts with the environment in consecutive trials. Each trial consists of sequential steps usually executed as follows:</p>
<ol class="simple">
<li><p>Filter population <span class="math notranslate nohighlight">\([P]\)</span> and select classifiers where condition matches environmental perception forming a <em>match-set</em> <span class="math notranslate nohighlight">\([M]\)</span>.</p></li>
<li><p>Determine action that will be executed (depending on the strategy).</p></li>
<li><p>Narrow-down the match-set by selecting only classifiers advocating proposed action.</p></li>
<li><p>Execute the action in the environment obtaining a new state</p></li>
<li><p>Refine classifiers by executing discovery and learning components.</p></li>
</ol>
<p>The action selection and classifiers evolution phases are implemented individually in different LCS, but the main objective of reaching ideal generalization level is crucial to all of them. The system should find a population that covers the search space as compactly as possible without being detrimental to the optimality of behavior.</p>
</div>
<div class="section" id="pittsburgh-vs-michigan">
<h3>Pittsburgh vs Michigan<a class="headerlink" href="#pittsburgh-vs-michigan" title="Permalink to this headline">¶</a></h3>
<p>One of the most fundamental distinction in LSC research is the way of storing knowledge by using two different approaches - <em>Michigan-style</em> or <em>Pittsburgh-style</em>. The first ones were proposed by Holland <span id="id20">[<a class="reference internal" href="../../bibliography.html#id22">2</a>]</span> while the latter one by Kenneth DeJong and his student <span id="id21">[<a class="reference internal" href="../../bibliography.html#id64">40</a>]</span> <span id="id22">[<a class="reference internal" href="../../bibliography.html#id65">41</a>]</span>.</p>
<p>The fundamental distinction is the structure of an individual. In Michigan systems each individual is a classifier, in Pittsburgh each individual is a set of classifiers - see Figure <a class="reference internal" href="#michigan-pittsburgh-fig"><span class="std std-numref">2.1</span></a>.</p>
<div class="figure align-default" id="michigan-pittsburgh-fig">
<img alt="../../_images/michigan_pittsburgh.png" src="../../_images/michigan_pittsburgh.png" />
<p class="caption"><span class="caption-number">Fig. 2.1 </span><span class="caption-text">Differences between representing knowledge in both Michigan-style and Pittsburgh-style LCS. Figure taken from <span id="id23">[<a class="reference internal" href="../../bibliography.html#id66">42</a>]</span>.</span><a class="headerlink" href="#michigan-pittsburgh-fig" title="Permalink to this image">¶</a></p>
</div>
<p>Therefore, the classifiers in Michigan-style LCS are being continuously evaluated and evolved, while in Pittsburgh-style LCS the same process is much more complicated because the whole population needs to be assessed. Thus, Michigan-style systems are typically applied in interactive, online learning problems, while Pittsburgh ones are rather suitable for offline learning <span id="id24">[<a class="reference internal" href="../../bibliography.html#id66">42</a>]</span>. This work focuses on the first class of LCS.</p>
</div>
</div>
<div class="section" id="representative-lcs">
<h2>Representative LCS<a class="headerlink" href="#representative-lcs" title="Permalink to this headline">¶</a></h2>
<p>This sections describes Michigan-style LCS implementations contributing mostly to the current advancements.</p>
<div class="section" id="cs-1">
<h3>CS-1<a class="headerlink" href="#cs-1" title="Permalink to this headline">¶</a></h3>
<p>Two years after presenting the theoretical model of CS Holland and Reitman proposed its implementation CS-1 <span id="id25">[<a class="reference internal" href="../../bibliography.html#id22">2</a>]</span>. The system realized the Darwinian principle of the <em>survival of the fittest</em> and was generating adaptive behaviour by maximizing reinforcement using the bucket brigade algorithm <span id="id26">[<a class="reference internal" href="../../bibliography.html#id75">43</a>]</span>.</p>
<p>Some internal mechanisms like the usage of a message list or interactions between evolving both single classifier and entire population were considered difficult <span id="id27">[<a class="reference internal" href="../../bibliography.html#id76">44</a>]</span> which signified the need for improvements.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition-steward-wilson admonition">
<p class="admonition-title">Steward Wilson</p>
<img alt="../../_images/steward_wilson.gif" src="../../_images/steward_wilson.gif" />
<p><a class="reference external" href="https://ieeexplore.ieee.org/author/37550361200">Steward Wilson</a> is an Independent Researcher in classifier systems and evolutionary computation.</p>
<p>His Ph.D. thesis investigated what would happen if a child could ask questions and receive excellent spoken answers from a machine that connected him to recordings made by a scientist such as Carl Sagan. The results showed long, thoughtful lines of inquiry for this student-driven style of learning.</p>
</div>
</div>
</div>
<div class="section" id="zcs">
<h3>ZCS<a class="headerlink" href="#zcs" title="Permalink to this headline">¶</a></h3>
<p>The <em>Zeroth Level Classifier</em> (ZCS) introduced by Wilson in 1994 <span id="id28">[<a class="reference internal" href="../../bibliography.html#id77">45</a>]</span> encompasses all LCS components while simplifying the CS-1 increasing its understandability and performance. The major changes was the removing of the internal message list (determining the rule’s format entirely by the system interface) alongside with rule-bidding credit assignment (replacing it with Q-learning <span id="id29">[<a class="reference internal" href="../../bibliography.html#id78">46</a>]</span>).</p>
<p>Moreover, the classifier fitness was based on the accumulated reward that the agent can get from firing the classifier which gave rise to the <em>“strength-based”</em> family of LCS. As a result the discovery component eliminates classifiers providing less reward than others from the population.</p>
<p>This premature converge onto suboptimal rules before search space can be properly explored and stable population formed led Wilson to consider other ways in which this might be achieved.</p>
</div>
<div class="section" id="xcs">
<span id="section-topics-history-xcs"></span><h3>XCS<a class="headerlink" href="#xcs" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Learning_classifier_system">wiki</a>
XCS <span id="id30">[<a class="reference internal" href="../../bibliography.html#id28">47</a>]</span> <span id="id31">[<a class="reference internal" href="../../bibliography.html#id4">48</a>]</span> <span id="id32">[<a class="reference internal" href="../../bibliography.html#id5">49</a>]</span></p>
<p>XCS uses niche-GA [Booker, 1985] meaning that GA acts in the action space <span class="math notranslate nohighlight">\([A]\)</span>, instead of globally.</p>
</div>
</div>
<div class="section" id="anticipatory-learning-classifier-systems">
<h2>Anticipatory Learning Classifier Systems<a class="headerlink" href="#anticipatory-learning-classifier-systems" title="Permalink to this headline">¶</a></h2>
<div class="section" id="acs2">
<h3>ACS2<a class="headerlink" href="#acs2" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">lcs.agents.acs2</span> <span class="k">as</span> <span class="nn">acs2</span>
<span class="kn">from</span> <span class="nn">lcs.metrics</span> <span class="kn">import</span> <span class="n">population_metrics</span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Tuple</span>

<span class="k">def</span> <span class="nf">maze_metrics</span><span class="p">(</span><span class="n">agent</span><span class="p">,</span> <span class="n">env</span><span class="p">):</span>
    <span class="n">metrics</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">metrics</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">population_metrics</span><span class="p">(</span><span class="n">agent</span><span class="o">.</span><span class="n">population</span><span class="p">,</span> <span class="n">env</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">metrics</span>

<span class="n">acs2_base_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;classifier_length&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="s1">&#39;number_of_possible_actions&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="s1">&#39;biased_exploration&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;metrics_trial_frequency&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;user_metrics_collector_fcn&#39;</span><span class="p">:</span> <span class="n">maze_metrics</span>
<span class="p">}</span>

<span class="k">def</span> <span class="nf">run_acs2_explore_exploit</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">explore_trials</span><span class="p">,</span> <span class="n">exploit_trials</span><span class="p">,</span> <span class="o">**</span><span class="n">config</span><span class="p">):</span>
    <span class="n">cfg</span> <span class="o">=</span> <span class="n">acs2</span><span class="o">.</span><span class="n">Configuration</span><span class="p">(</span><span class="o">**</span><span class="n">config</span><span class="p">)</span>

    <span class="c1"># explore phase</span>
    <span class="n">agent</span> <span class="o">=</span> <span class="n">acs2</span><span class="o">.</span><span class="n">ACS2</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
    <span class="n">metrics_explore</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">explore</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">explore_trials</span><span class="p">)</span>

    <span class="c1"># exploit phase</span>
    <span class="n">agent_exploit</span> <span class="o">=</span> <span class="n">acs2</span><span class="o">.</span><span class="n">ACS2</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">copy</span><span class="p">(</span><span class="n">agent</span><span class="o">.</span><span class="n">population</span><span class="p">))</span>
    <span class="n">metrics_exploit</span> <span class="o">=</span> <span class="n">agent_exploit</span><span class="o">.</span><span class="n">exploit</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">exploit_trials</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">agent</span><span class="p">,</span> <span class="n">metrics_explore</span><span class="p">),</span> <span class="p">(</span><span class="n">agent_exploit</span><span class="p">,</span> <span class="n">metrics_exploit</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">find_best_classifier</span><span class="p">(</span><span class="n">population</span><span class="p">:</span> <span class="n">acs2</span><span class="o">.</span><span class="n">ClassifiersList</span><span class="p">,</span> <span class="n">situation</span><span class="p">:</span> <span class="n">Perception</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">acs2</span><span class="o">.</span><span class="n">Classifier</span><span class="p">]:</span>
    <span class="n">match_set</span> <span class="o">=</span> <span class="n">population</span><span class="o">.</span><span class="n">form_match_set</span><span class="p">(</span><span class="n">situation</span><span class="p">)</span>
    <span class="n">anticipated_change_cls</span> <span class="o">=</span> <span class="p">[</span><span class="n">cl</span> <span class="k">for</span> <span class="n">cl</span> <span class="ow">in</span> <span class="n">match_set</span> <span class="k">if</span> <span class="n">cl</span><span class="o">.</span><span class="n">does_anticipate_change</span><span class="p">()]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">anticipated_change_cls</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">anticipated_change_cls</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">cl</span><span class="p">:</span> <span class="n">cl</span><span class="o">.</span><span class="n">fitness</span><span class="p">)</span>

    <span class="k">return</span> <span class="kc">None</span>

<span class="k">def</span> <span class="nf">build_fitness_and_action_matrices</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">population</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">:</span>
    <span class="n">original</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">maze</span><span class="o">.</span><span class="n">matrix</span>

    <span class="n">fitness</span> <span class="o">=</span> <span class="n">original</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">action</span> <span class="o">=</span> <span class="n">original</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

    <span class="n">action_lookup</span> <span class="o">=</span> <span class="p">{</span>
        <span class="mi">0</span><span class="p">:</span> <span class="sa">u</span><span class="s1">&#39;↑&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="sa">u</span><span class="s1">&#39;↗&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="sa">u</span><span class="s1">&#39;→&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="sa">u</span><span class="s1">&#39;↘&#39;</span><span class="p">,</span>
        <span class="mi">4</span><span class="p">:</span> <span class="sa">u</span><span class="s1">&#39;↓&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="sa">u</span><span class="s1">&#39;↙&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="sa">u</span><span class="s1">&#39;←&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="sa">u</span><span class="s1">&#39;↖&#39;</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">(</span><span class="n">original</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># path</span>
            <span class="n">perception</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">maze</span><span class="o">.</span><span class="n">perception</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="n">best_cl</span> <span class="o">=</span> <span class="n">find_best_classifier</span><span class="p">(</span><span class="n">population</span><span class="p">,</span> <span class="n">perception</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">best_cl</span><span class="p">:</span>
                <span class="n">fitness</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">best_cl</span><span class="o">.</span><span class="n">fitness</span>
                <span class="n">action</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">action_lookup</span><span class="p">[</span><span class="n">best_cl</span><span class="o">.</span><span class="n">action</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fitness</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="n">action</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;?&#39;</span>

        <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># wall</span>
            <span class="n">fitness</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">action</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;\#&#39;</span>

        <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>  <span class="c1"># reward</span>
            <span class="c1"># add 500 to make it more distinguishable</span>
            <span class="n">fitness</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">fitness</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">500</span>
            <span class="n">action</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;R&#39;</span>

    <span class="k">return</span> <span class="n">fitness</span><span class="p">,</span> <span class="n">action</span>

<span class="k">def</span> <span class="nf">plot_policy</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">fitness_matrix</span><span class="p">,</span> <span class="n">action_matrix</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

    <span class="n">max_x</span><span class="p">,</span> <span class="n">max_y</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">maze</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">shape</span>

    <span class="c1"># Render maze as image</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">fitness_matrix</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_x</span><span class="p">,</span> <span class="n">max_y</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

    <span class="c1"># Add labels to each cell</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">(</span><span class="n">action_matrix</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mf">0.4</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;$</span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Policy in Maze5 environment&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_x</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">max_y</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_x</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_y</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">plot_dir</span><span class="si">}</span><span class="s1">/acs2-maze5-policy.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">PLOT_DPI</span><span class="p">)</span>

<span class="nd">@get_from_cache_or_run</span><span class="p">(</span><span class="n">cache_path</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cache_dir</span><span class="si">}</span><span class="s1">/acs2_maze5.dill&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">run_acs2_in_maze5</span><span class="p">():</span>
    <span class="n">env</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s1">&#39;Maze5-v0&#39;</span><span class="p">)</span>
    <span class="n">explore_phase</span><span class="p">,</span> <span class="n">exploit_phase</span> <span class="o">=</span> <span class="n">run_acs2_explore_exploit</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">explore_trials</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">exploit_trials</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="o">**</span><span class="n">acs2_base_params</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">env</span><span class="p">,</span> <span class="n">explore_phase</span><span class="p">,</span> <span class="n">exploit_phase</span>

<span class="c1"># Run computation</span>
<span class="n">env_</span><span class="p">,</span> <span class="n">explore_</span><span class="p">,</span> <span class="n">exploit_</span> <span class="o">=</span> <span class="n">run_acs2_in_maze5</span><span class="p">()</span>

<span class="c1"># Plot the policy</span>
<span class="n">fitness_matrix</span><span class="p">,</span> <span class="n">action_matrix</span> <span class="o">=</span> <span class="n">build_fitness_and_action_matrices</span><span class="p">(</span><span class="n">env_</span><span class="p">,</span> <span class="n">explore_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">population</span><span class="p">)</span>
<span class="n">plot_policy</span><span class="p">(</span><span class="n">env_</span><span class="p">,</span> <span class="n">fitness_matrix</span><span class="p">,</span> <span class="n">action_matrix</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="full-width figure align-default" id="maze5-fig">
<img alt="../../_images/acs2-maze5-policy.png" src="../../_images/acs2-maze5-policy.png" />
<p class="caption"><span class="caption-number">Fig. 2.2 </span><span class="caption-text">Policy of Maze5. Saturation of red color reflects the best classifier fitness value.</span><a class="headerlink" href="#maze5-fig" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="macs">
<h3>MACS<a class="headerlink" href="#macs" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">lcs.agents.macs.macs</span> <span class="k">as</span> <span class="nn">macs</span>

<span class="n">maze228_env</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s1">&#39;Maze228-v0&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_calculate_rotating_maze_knowledge</span><span class="p">(</span><span class="n">agent</span><span class="p">:</span> <span class="n">macs</span><span class="o">.</span><span class="n">MACS</span><span class="p">,</span> <span class="n">env</span><span class="p">):</span>
    <span class="n">transitions</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">transitions</span>
    <span class="n">covered_transitions</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">p0</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p1</span> <span class="ow">in</span> <span class="n">transitions</span><span class="p">:</span>
        <span class="n">p0p</span> <span class="o">=</span> <span class="n">Perception</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">p0</span><span class="p">)))</span>
        <span class="n">p1p</span> <span class="o">=</span> <span class="n">Perception</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">p1</span><span class="p">)))</span>
        <span class="n">anticipations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">agent</span><span class="o">.</span><span class="n">get_anticipations</span><span class="p">(</span><span class="n">p0p</span><span class="p">,</span> <span class="n">a</span><span class="p">))</span>

        <span class="c1"># accurate classifiers</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">anticipations</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">anticipations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">p1p</span><span class="p">:</span>
            <span class="n">covered_transitions</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">covered_transitions</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">transitions</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_macs_metrics</span><span class="p">(</span><span class="n">agent</span><span class="p">:</span> <span class="n">macs</span><span class="o">.</span><span class="n">MACS</span><span class="p">,</span> <span class="n">env</span><span class="p">):</span>
    <span class="n">population</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">population</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;pop&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">population</span><span class="p">),</span>
        <span class="s1">&#39;situations&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">agent</span><span class="o">.</span><span class="n">desirability_values</span><span class="p">),</span>
        <span class="s1">&#39;0_cls&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">([</span><span class="n">cl</span> <span class="k">for</span> <span class="n">cl</span> <span class="ow">in</span> <span class="n">population</span> <span class="k">if</span> <span class="n">cl</span><span class="o">.</span><span class="n">action</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">cl</span><span class="o">.</span><span class="n">is_accurate</span><span class="p">]),</span>
        <span class="s1">&#39;1_cls&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">([</span><span class="n">cl</span> <span class="k">for</span> <span class="n">cl</span> <span class="ow">in</span> <span class="n">population</span> <span class="k">if</span> <span class="n">cl</span><span class="o">.</span><span class="n">action</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">cl</span><span class="o">.</span><span class="n">is_accurate</span><span class="p">]),</span>
        <span class="s1">&#39;2_cls&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">([</span><span class="n">cl</span> <span class="k">for</span> <span class="n">cl</span> <span class="ow">in</span> <span class="n">population</span> <span class="k">if</span> <span class="n">cl</span><span class="o">.</span><span class="n">action</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">cl</span><span class="o">.</span><span class="n">is_accurate</span><span class="p">]),</span>
        <span class="s1">&#39;knowledge&#39;</span><span class="p">:</span> <span class="n">_calculate_rotating_maze_knowledge</span><span class="p">(</span><span class="n">agent</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
    <span class="p">}</span>

<span class="nd">@get_from_cache_or_run</span><span class="p">(</span><span class="n">cache_path</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cache_dir</span><span class="si">}</span><span class="s1">/macs_maze228.dill&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">run_macs_in_maze228</span><span class="p">(</span><span class="n">env</span><span class="p">):</span>
    <span class="n">cfg</span> <span class="o">=</span> <span class="n">macs</span><span class="o">.</span><span class="n">Configuration</span><span class="p">(</span><span class="n">classifier_length</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span>
                        <span class="n">number_of_possible_actions</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                        <span class="n">feature_possible_values</span><span class="o">=</span><span class="p">[{</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;9&#39;</span><span class="p">}]</span> <span class="o">*</span> <span class="mi">8</span> <span class="o">+</span> <span class="p">[{</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;9&#39;</span><span class="p">}],</span>
                        <span class="n">estimate_expected_improvements</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">metrics_trial_frequency</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                        <span class="n">user_metrics_collector_fcn</span><span class="o">=</span><span class="n">_macs_metrics</span><span class="p">)</span>

    <span class="n">agent</span> <span class="o">=</span> <span class="n">macs</span><span class="o">.</span><span class="n">MACS</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
    <span class="n">metrics</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">explore</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">agent</span><span class="p">,</span> <span class="n">metrics</span>

<span class="c1"># run computations</span>
<span class="n">macs_agent</span><span class="p">,</span> <span class="n">macs_metrics</span> <span class="o">=</span> <span class="n">run_macs_in_maze228</span><span class="p">(</span><span class="n">maze228_env</span><span class="p">)</span>

<span class="c1"># visualization</span>
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">129</span><span class="p">)</span>  <span class="c1"># found experimentally</span>
<span class="n">maze228_env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="n">maze228_env</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>

<span class="n">left_from_reward</span> <span class="o">=</span> <span class="n">maze228_env</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">maze</span><span class="o">.</span><span class="n">perception</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Perception: </span><span class="si">{</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">left_from_reward</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-Black">■</span>
<span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-White">□</span> <span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-White">□</span> <span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-White">□</span> <span class=" -Color -Color-Black">■</span>
<span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-White">□</span> <span class=" -Color -Color-White">□</span> <span class=" -Color -Color-White">□</span> <span class=" -Color -Color-White">□</span> <span class=" -Color -Color-White">□</span> <span class=" -Color -Color-Black">■</span>
<span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-White">□</span> <span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-White">□</span> <span class=" -Color -Color-White">□</span> <span class=" -Color -Color-Black">■</span>
<span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-White">□</span> <span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-White">□</span> <span class=" -Color -Color-White">□</span> <span class=" -Color -Color-White">□</span> <span class=" -Color -Color-Black">■</span>
<span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-White">□</span> <span class=" -Color -Color-White">□</span> <span class=" -Color -Color-White">□</span> <span class=" -Color -Color-Red">A</span> <span class=" -Color -Color-Yellow">$</span> <span class=" -Color -Color-Black">■</span>
<span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-Black">■</span>
Perception: 009111000
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Total MACS population size: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">macs_agent</span><span class="o">.</span><span class="n">population</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">s</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">macs_agent</span><span class="o">.</span><span class="n">population</span><span class="o">.</span><span class="n">form_match_set</span><span class="p">(</span><span class="n">left_from_reward</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">cl</span><span class="p">:</span> <span class="n">cl</span><span class="o">.</span><span class="n">action</span><span class="p">)</span>

<span class="n">action_mapping</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;STEP_AHEAD&#39;</span><span class="p">,</span> <span class="s1">&#39;ROTATE_LEFT&#39;</span><span class="p">,</span> <span class="s1">&#39;ROTATE_RIGHT&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">action</span><span class="p">,</span> <span class="n">group_cl</span> <span class="ow">in</span> <span class="n">groupby</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">cl</span><span class="p">:</span> <span class="n">cl</span><span class="o">.</span><span class="n">action</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Action: </span><span class="si">{</span><span class="n">action_mapping</span><span class="p">[</span><span class="n">action</span><span class="p">]</span><span class="si">}</span><span class="s1">, anticipation: </span><span class="si">{</span><span class="nb">list</span><span class="p">((</span><span class="n">macs_agent</span><span class="o">.</span><span class="n">get_anticipations</span><span class="p">(</span><span class="n">left_from_reward</span><span class="p">,</span> <span class="n">action</span><span class="p">)))</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">cl</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">group_cl</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">cl</span><span class="p">:</span> <span class="n">cl</span><span class="o">.</span><span class="n">effect</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="si">{</span><span class="n">cl</span><span class="o">.</span><span class="n">condition</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">cl</span><span class="o">.</span><span class="n">action</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">cl</span><span class="o">.</span><span class="n">effect</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total MACS population size: 211

Action: STEP_AHEAD, anticipation: [0 0 0 9 0 0 0 1 0]
	0#9###### 0 0????????
	#0###10## 0 ?0???????
	0#9##1### 0 ?0???????
	#0####### 0 ??0??????
	0#9###### 0 ???9?????
	0######## 0 ????0????
	0#####0## 0 ?????0???
	#######0# 0 ??????0??
	##9###### 0 ??????0??
	##91#10## 0 ???????1?
	0######## 0 ????????0

Action: ROTATE_LEFT, anticipation: [0 0 0 0 9 1 1 1 0]
	######0## 1 0????????
	#######0# 1 ?0???????
	0######## 1 ??0??????
	#0####### 1 ???0?????
	##9###### 1 ????9????
	###1##### 1 ?????1???
	####1#### 1 ??????1??
	#####1### 1 ???????1?
	######### 1 ????????0

Action: ROTATE_RIGHT, anticipation: [9 1 1 1 0 0 0 0 0]
	##9###### 2 9????????
	###1##### 2 ?1???????
	####1#### 2 ??1??????
	#####1### 2 ???1?????
	######0## 2 ????0????
	#######0# 2 ?????0???
	0######## 2 ??????0??
	#0####### 2 ???????0?
	######### 2 ????????0
</pre></div>
</div>
</div>
</div>
<p>Comparing the ACS2 agent in the same environment</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">_acs2_metrics</span><span class="p">(</span><span class="n">agent</span><span class="p">:</span> <span class="n">acs2</span><span class="o">.</span><span class="n">ACS2</span><span class="p">,</span> <span class="n">env</span><span class="p">):</span>
    <span class="n">population</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">population</span>
    <span class="n">reliable</span> <span class="o">=</span> <span class="p">[</span><span class="n">cl</span> <span class="k">for</span> <span class="n">cl</span> <span class="ow">in</span> <span class="n">population</span> <span class="k">if</span> <span class="n">cl</span><span class="o">.</span><span class="n">is_reliable</span><span class="p">()]</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;pop&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">population</span><span class="p">),</span>
        <span class="s1">&#39;rel&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">reliable</span><span class="p">)</span>
    <span class="p">}</span>

<span class="nd">@get_from_cache_or_run</span><span class="p">(</span><span class="n">cache_path</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cache_dir</span><span class="si">}</span><span class="s1">/acs2_maze228.dill&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">run_acs2_in_maze228</span><span class="p">(</span><span class="n">env</span><span class="p">):</span>
    <span class="n">cfg</span> <span class="o">=</span> <span class="n">acs2</span><span class="o">.</span><span class="n">Configuration</span><span class="p">(</span><span class="n">classifier_length</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span>
                        <span class="n">number_of_possible_actions</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                        <span class="n">metrics_trial_frequency</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                        <span class="n">user_metrics_collector_fcn</span><span class="o">=</span><span class="n">_acs2_metrics</span><span class="p">,</span>
                        <span class="n">do_ga</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">agent</span> <span class="o">=</span> <span class="n">acs2</span><span class="o">.</span><span class="n">ACS2</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
    <span class="n">metrics</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">explore</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">agent</span><span class="p">,</span> <span class="n">metrics</span>

<span class="n">acs2_agent</span><span class="p">,</span> <span class="n">acs2_metrics</span> <span class="o">=</span> <span class="n">run_acs2_in_maze228</span><span class="p">(</span><span class="n">maze228_env</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reliable_classifiers</span> <span class="o">=</span> <span class="p">[</span><span class="n">cl</span> <span class="k">for</span> <span class="n">cl</span> <span class="ow">in</span> <span class="n">acs2_agent</span><span class="o">.</span><span class="n">population</span> <span class="k">if</span> <span class="n">cl</span><span class="o">.</span><span class="n">is_reliable</span><span class="p">()]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Total reliable population for ACS2: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">reliable_classifiers</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">cl</span> <span class="ow">in</span> <span class="n">acs2_agent</span><span class="o">.</span><span class="n">population</span><span class="o">.</span><span class="n">form_match_set</span><span class="p">(</span><span class="n">left_from_reward</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">cl</span><span class="o">.</span><span class="n">is_reliable</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cl</span><span class="o">.</span><span class="n">condition</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">cl</span><span class="o">.</span><span class="n">action</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">cl</span><span class="o">.</span><span class="n">effect</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total reliable population for ACS2: 402
##911#00# 1 ##009#11#
##9111#0# 0 ##0900#1#
009#11### 2 911#00###
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<p><strong>Software packages used</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">session_info</span>
<span class="n">session_info</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><details>
<summary>Click to view session information</summary>
<pre>
-----
gym                 0.21.0
gym_maze            NA
lcs                 NA
matplotlib          3.5.1
numpy               1.22.1
session_info        1.0.0
src                 (embedded book's utils module)
-----
</pre>
<details>
<summary>Click to view modules imported as dependencies</summary>
<pre>
PIL                         8.4.0
asttokens                   NA
backcall                    0.2.0
brotli                      NA
certifi                     2021.10.08
cffi                        1.15.0
charset_normalizer          2.0.10
click                       7.1.2
cloudpickle                 2.0.0
colorama                    0.4.4
colorful                    0.5.4
colorful_orig               0.5.4
cryptography                36.0.1
cycler                      0.10.0
cython_runtime              NA
databricks_cli              NA
dateutil                    2.8.2
debugpy                     1.5.1
decorator                   5.1.1
defusedxml                  0.7.1
dill                        0.3.4
entrypoints                 0.3
executing                   0.8.2
filelock                    3.4.2
google                      NA
grpc                        1.43.0
hiredis                     2.0.0
idna                        3.3
importlib_metadata          NA
ipykernel                   6.7.0
ipython_genutils            0.2.0
jedi                        0.18.1
kiwisolver                  1.3.2
lxml                        4.7.1
matplotlib_inline           NA
mlflow                      1.23.1
mpl_toolkits                NA
msgpack                     1.0.3
networkx                    2.5
packaging                   21.3
pandas                      1.4.0
parso                       0.8.3
pexpect                     4.8.0
pickleshare                 0.7.5
pkg_resources               NA
prompt_toolkit              3.0.26
psutil                      5.9.0
ptyprocess                  0.7.0
pure_eval                   0.2.2
pydev_ipython               NA
pydevconsole                NA
pydevd                      2.6.0
pydevd_concurrency_analyser NA
pydevd_file_utils           NA
pydevd_plugins              NA
pydevd_tracing              NA
pygments                    2.11.2
pylab                       NA
pyparsing                   3.0.7
pytz                        2021.3
ray                         1.9.2
redis                       4.1.2
requests                    2.27.1
scipy                       1.7.3
setproctitle                1.2.2
setuptools                  60.5.0
six                         1.16.0
socks                       1.7.1
sphinxcontrib               NA
stack_data                  0.1.4
tornado                     6.1
tqdm                        4.62.3
traitlets                   5.1.1
typing_extensions           NA
unicodedata2                NA
urllib3                     1.26.8
wcwidth                     0.2.5
yaml                        6.0
zipp                        NA
zmq                         22.3.0
</pre>
</details> <!-- seems like this ends pre, so might as well be explicit -->
<pre>
-----
IPython             8.0.1
jupyter_client      7.1.2
jupyter_core        4.9.1
notebook            6.4.8
-----
Python 3.9.10 | packaged by conda-forge | (main, Feb  1 2022, 21:24:11) [GCC 9.4.0]
Linux-5.13.0-28-generic-x86_64-with-glibc2.31
-----
Session information updated at 2022-02-10 13:30
</pre>
</details></div></div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapters/2_selected_topics"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="21_introduction.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">2. </span>Selected topics of Learning Classifier Systems</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="23_real_value_challenge.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">2.2. </span>Real-valued signal challenge</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Norbert Kozłowski<br/>
    
        &copy; Copyright 2021.<br/>
      <div class="extra_footer">
        <div><a href="https://wit.pwr.edu.pl/en/">Faculty of Computer Science and Telecommunications</a> - <a href="https://dce.pwr.edu.pl/">Department of Computer Engineering</a></div> 

      </div>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>