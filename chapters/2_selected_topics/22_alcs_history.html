
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>2.1. Road towards Anticipatory Learning Classifier Systems &#8212; Real-valued Anticipatory Classifier System</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="2.2. Real-valued signal challenge" href="23_real_value_challenge.html" />
    <link rel="prev" title="2. Selected topics of Learning Classifier Systems" href="21_introduction.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/pwr_logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Real-valued Anticipatory Classifier System</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Real-valued Anticipatory Classifier System
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_introduction/11_introduction.html">
   1. Introduction
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_introduction/12_motivation.html">
     1.1. Motivation and challenges
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_introduction/13_aims_goals.html">
     1.2. Research hypothesis, its aims and goals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_introduction/14_structure.html">
     1.3. Thesis structure
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="21_introduction.html">
   2. Selected topics of Learning Classifier Systems
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     2.1. Road towards Anticipatory Learning Classifier Systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="23_real_value_challenge.html">
     2.2. Real-valued signal challenge
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="24_kpi.html">
     2.3. Key Performance Indicators
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="25_stats.html">
     2.4. Statistical verification of results
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="26_envs.html">
     2.5. Overview of the selected environments
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_internalizing/31_introduction.html">
   3. Ways of handling real-valued input signal
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../3_internalizing/interval/32_interval_based_representation.html">
     3.1. Interval-based representation
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../3_internalizing/interval/32_experiment_1.html">
       Experiment 1 - Encoding precision
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../3_internalizing/interval/32_experiment_2.html">
       Experiment 2 - Nature of the intervals
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../3_internalizing/discretization/33_discretizing_input_signal.html">
     3.2. Discretizing input signal
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../3_internalizing/discretization/33_experiment_3.html">
       Experiment 3 - Single-step environment performance
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../3_internalizing/discretization/33_experiment_4.html">
       Experiment 4 - Multiple-step environments performance
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_biased_exploration/41_introduction.html">
   4. Optimizing formation of internal model
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../4_biased_exploration/41_biased_exploration.html">
     4.1. Biased exploration
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
    <label for="toctree-checkbox-7">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../4_biased_exploration/41_experiment_1.html">
       Experiment 1 - Single-step problem performance
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../4_biased_exploration/41_experiment_2.html">
       Experiment 2 - Multi-steps problems performance
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../4_biased_exploration/41_experiment_3.html">
       Experiment 3 - Balancing the pole
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_diminishing_reward/51_introduction.html">
   5. Optimizing reward distribution through long action chains
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../5_diminishing_reward/51_diminishing_reward.html">
     5.1. Diminishing reward
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
    <label for="toctree-checkbox-9">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../5_diminishing_reward/51_experiment_1.html">
       Experiment 1 - Straight Corridor
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../5_diminishing_reward/51_experiment_2.html">
       Experiment 2 - Deceptive Corridor
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../6_summary/61_summary.html">
   6. Summary
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../6_summary/62_conclusions.html">
     6.1. Conclusions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../6_summary/63_future.html">
     6.2. Future Works
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../6_summary/64_publications.html">
     6.3. Publications
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../abbreviations.html">
   7. Abbreviations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../bibliography.html">
   8. Bibliography
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/chapters/2_selected_topics/22_alcs_history.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/khozzy/phd"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/khozzy/phd/issues/new?title=Issue%20on%20page%20%2Fchapters/2_selected_topics/22_alcs_history.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/khozzy/phd/gh-pages?urlpath=tree/chapters/2_selected_topics/22_alcs_history.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#selected-topics-of-lcs">
   Selected topics of LCS
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rules-and-classifiers">
     Rules and Classifiers
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#driving-mechanisms">
     Driving Mechanisms
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#functional-cycle">
     Functional cycle
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pittsburgh-vs-michigan-approach">
     Pittsburgh vs Michigan approach
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#representative-lcs">
   Representative LCS
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cs-1">
     CS-1
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#zcs">
     ZCS
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#xcs">
     XCS
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#modern-lcs">
     Modern LCS
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#anticipatory-learning-classifier-systems">
   Anticipatory Learning Classifier Systems
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cfcs2">
     CFCS2
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#acs">
     ACS
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#acs2">
     ACS2
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#yacs">
     YACS
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#macs">
     MACS
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Road towards Anticipatory Learning Classifier Systems</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#selected-topics-of-lcs">
   Selected topics of LCS
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rules-and-classifiers">
     Rules and Classifiers
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#driving-mechanisms">
     Driving Mechanisms
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#functional-cycle">
     Functional cycle
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pittsburgh-vs-michigan-approach">
     Pittsburgh vs Michigan approach
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#representative-lcs">
   Representative LCS
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cs-1">
     CS-1
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#zcs">
     ZCS
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#xcs">
     XCS
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#modern-lcs">
     Modern LCS
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#anticipatory-learning-classifier-systems">
   Anticipatory Learning Classifier Systems
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cfcs2">
     CFCS2
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#acs">
     ACS
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#acs2">
     ACS2
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#yacs">
     YACS
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#macs">
     MACS
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gym</span>
<span class="kn">import</span> <span class="nn">gym_maze</span>  <span class="c1"># noqa: F401</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">pathlib</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">groupby</span>

<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="kn">from</span> <span class="nn">tabulate</span> <span class="kn">import</span> <span class="n">tabulate</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">HTML</span>

<span class="kn">from</span> <span class="nn">src.decorators</span> <span class="kn">import</span> <span class="n">get_from_cache_or_run</span>
<span class="kn">from</span> <span class="nn">lcs</span> <span class="kn">import</span> <span class="n">Perception</span>

<span class="kn">from</span> <span class="nn">src.visualization</span> <span class="kn">import</span> <span class="n">PLOT_DPI</span>
<span class="kn">from</span> <span class="nn">src.utils</span> <span class="kn">import</span> <span class="n">build_plots_dir_path</span><span class="p">,</span> <span class="n">build_cache_dir_path</span>

<span class="n">root_dir</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">()</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span>
<span class="n">cwd_dir_name</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">()</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span><span class="o">.</span><span class="n">name</span>

<span class="n">plot_dir</span> <span class="o">=</span> <span class="n">build_plots_dir_path</span><span class="p">(</span><span class="n">root_dir</span><span class="p">)</span> <span class="o">/</span> <span class="n">cwd_dir_name</span>
<span class="n">cache_dir</span> <span class="o">=</span> <span class="n">build_cache_dir_path</span><span class="p">(</span><span class="n">root_dir</span><span class="p">)</span> <span class="o">/</span> <span class="n">cwd_dir_name</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ioff</span><span class="p">();</span>  <span class="c1"># turn off interactive plotting</span>
</pre></div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="road-towards-anticipatory-learning-classifier-systems">
<h1><span class="section-number">2.1. </span>Road towards Anticipatory Learning Classifier Systems<a class="headerlink" href="#road-towards-anticipatory-learning-classifier-systems" title="Permalink to this headline">¶</a></h1>
<p>The concept of LCS was introduced by John Holland in 1975 <span id="id1">[<a class="reference internal" href="../../bibliography.html#id48">3</a>]</span> to model the idea of cognition based on adaptive mechanisms. From the early days, they consist of a set of rules named <em>classifiers</em> combined with mechanisms in charge of evolving them. Initially, the goal was to handle problems related to online interaction with external environments, as described by Wilson in <span id="id2">[<a class="reference internal" href="../../bibliography.html#id49">42</a>]</span>.</p>
<p>To accomplish this, the emphasis was put on parallelism in the architecture and evolutionary mechanisms allowing the agent to adapt to potentially changing environments <span id="id3">[<a class="reference internal" href="../../bibliography.html#id50">43</a>]</span>. This approach was referenced as <em>“escaping brittleness”</em> <span id="id4">[<a class="reference internal" href="../../bibliography.html#id51">44</a>]</span> due to the problems related to the lack of robustness of the current artificial intelligence systems.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition-john-henry-holland admonition">
<p class="admonition-title">John Henry Holland</p>
<img alt="../../_images/John_Holland.jpg" src="../../_images/John_Holland.jpg" />
<p><a class="reference external" href="https://en.wikipedia.org/wiki/John_Henry_Holland">John H. Holland</a> is best known for his role as a founding father of the complex systems approach. In particular, he developed genetic algorithms and learning classifier systems.</p>
<p>These foundational building blocks of an evolutionary optimization approach are now included in all texts on optimization and programming.</p>
</div>
</div>
<p>The naming convention used to refer to the LCS algorithm also changed since its infancy. Holland initially called it a classifier system, abbreviated either as (CS) or (CFS) <span id="id5">[<a class="reference internal" href="../../bibliography.html#id52">45</a>]</span>. From that time, it was also referred to as adaptive agents <span id="id6">[<a class="reference internal" href="../../bibliography.html#id53">46</a>]</span>, cognitive systems <span id="id7">[<a class="reference internal" href="../../bibliography.html#id53">46</a>]</span> <span id="id8">[<a class="reference internal" href="../../bibliography.html#id22">2</a>]</span> and genetic-based machine learning <span id="id9">[<a class="reference internal" href="../../bibliography.html#id24">21</a>]</span> <span id="id10">[<a class="reference internal" href="../../bibliography.html#id54">47</a>]</span>. The current name of LCS was not adopted until the late 80s <span id="id11">[<a class="reference internal" href="../../bibliography.html#id55">48</a>]</span> after extending the architecture with a credit assignment component <span id="id12">[<a class="reference internal" href="../../bibliography.html#id51">44</a>]</span> <span id="id13">[<a class="reference internal" href="../../bibliography.html#id56">49</a>]</span>.</p>
<p>This section provides a synopsis of crucial LCS concepts alongside the most popular variants and their contributions to the field.</p>
<div class="section" id="selected-topics-of-lcs">
<h2>Selected topics of LCS<a class="headerlink" href="#selected-topics-of-lcs" title="Permalink to this headline">¶</a></h2>
<div class="section" id="rules-and-classifiers">
<h3>Rules and Classifiers<a class="headerlink" href="#rules-and-classifiers" title="Permalink to this headline">¶</a></h3>
<p>LCS utilizes <em>rules</em> as a fundamental block of modelling knowledge in a general form. It comprises a <em>condition</em> (i.e. specified feature states) and an <em>action</em> (also referred to as the class). They can be interpreted using the “IF condition THEN action” logical expression. The generalization property using the “do not care” symbol # is possible when the condition part is expressed with either boolean or nominal representation. Two input situations are considered equivalent for a given classifier if the specified (non-#) values in the condition match the corresponding attributes of the two situations.</p>
<p>In addition to condition and action, a rule typically has many algorithm-related parameter values associated with it (like its performance or expected reward). The term <em>classifier</em> is used to describe a rule and its associated parameters.</p>
<p>It is essential to realize that LCS comprise a population of single rules that collaboratively seek to cover the problem space. The number of classifiers needed to solve the particular problem depends on factors like the problem complexity or rule representation used.</p>
</div>
<div class="section" id="driving-mechanisms">
<h3>Driving Mechanisms<a class="headerlink" href="#driving-mechanisms" title="Permalink to this headline">¶</a></h3>
<p>There are two fundamental components behind every LCS algorithm - discovery and learning (credit assignment). Both of them have generated respective fields of study, but in the context of LCS, we wish to understand their function and purpose.</p>
<p><strong>Discovery component</strong></p>
<p>The discovery component is responsible for exploring the search space of the target problem to uncover new rules. A vast majority of LCS algorithms employ some form of evolutionary computation, most often a genetic algorithm (GA), employing the Neo-Darwinist theory of natural selection <span id="id14">[<a class="reference internal" href="../../bibliography.html#id57">50</a>]</span> <span id="id15">[<a class="reference internal" href="../../bibliography.html#id54">47</a>]</span>. The evolution of rules is modelled after the evolution of organisms using the following biological analogies:</p>
<ol class="simple">
<li><p>a code is used to represent the genotype/genome (condition),</p></li>
<li><p>a solution (phenotype) representation is associated with that genome (action),</p></li>
<li><p>a phenotype selection process (survival of the fittest) - the fittest organism (rule) has the greatest chances of reproducing and passing parts of its genome to offspring,</p></li>
<li><p>certain genetic genome operators are utilized in order to chase after fitter organisms (rules) <span id="id16">[<a class="reference internal" href="../../bibliography.html#id45">51</a>]</span> <span id="id17">[<a class="reference internal" href="../../bibliography.html#id58">52</a>]</span>.</p></li>
</ol>
<p>Two genetic operators are typically used to alter genome (rule) - mutation and crossover (recombination). The first one randomly modifies an element in an individual’s genotype (rule), while the latter recombine parts of two favourable genotypes (rules), creating a new one. The selection pressure driving better organisms (rules) to reproduce more frequently depends on the fitness function. The fitness function quantifies the optimality of a given rule, allowing it to be ranked across the entire population.</p>
<p>GA implementation varies in particular LCS, but the overall scheme involves evaluating all available rules, selecting the most promising offsprings (according to fitness value), applying genetic operators, introducing new offspring back to the population set and finally removing surplus or under-performing individuals.</p>
<p><strong>Learning component</strong></p>
<p>As mentioned, each classifier is accompanied by specific parameter values. The iterative update of them drives the process of LCS reinforcement by distributing any incoming reward signal to the classifiers that are accountable for it. This process serves two purposes:</p>
<ol class="simple">
<li><p>identification of classifiers responsible for obtaining large future rewards,</p></li>
<li><p>encourage the discoverability of new rules (by directly affecting the fitness value)</p></li>
</ol>
<p>The learning strategy depends on the nature of the problem and is realized differently in LCS implementations. In all cases, however, the process is conducted through trial-and-error interactions with the environment, where the occasional immediate reward is used to generate the policy (state-action mapping of agent-environment interactions), maximizing long-term reward <span id="id18">[<a class="reference internal" href="../../bibliography.html#id29">53</a>]</span> <span id="id19">[<a class="reference internal" href="../../bibliography.html#id59">54</a>]</span> <span id="id20">[<a class="reference internal" href="../../bibliography.html#id60">55</a>]</span>.</p>
</div>
<div class="section" id="functional-cycle">
<h3>Functional cycle<a class="headerlink" href="#functional-cycle" title="Permalink to this headline">¶</a></h3>
<p>The agent interacts with the environment in consecutive trials. Each trial consists of sequential steps usually executed as follows:</p>
<ol class="simple">
<li><p>Filter population <span class="math notranslate nohighlight">\([P]\)</span> and select classifiers where condition matches environmental perception forming a <em>match-set</em> <span class="math notranslate nohighlight">\([M]\)</span>.</p></li>
<li><p>Determine the action that will be executed (depending on the strategy).</p></li>
<li><p>Narrow down the match-set by selecting only classifiers advocating proposed action - create the <em>action-set</em> <span class="math notranslate nohighlight">\([A]\)</span>.</p></li>
<li><p>Execute the action in the environment, obtaining a new state</p></li>
<li><p>Refine classifiers by executing discovery and learning components.</p></li>
</ol>
<p>The action selection and classifiers evolution phases are implemented individually in different LCS, but the main objective of reaching the ideal generalization level is crucial to all of them. The system should find a population that covers the search space as compactly as possible without being detrimental to the optimality of behaviour.</p>
</div>
<div class="section" id="pittsburgh-vs-michigan-approach">
<h3>Pittsburgh vs Michigan approach<a class="headerlink" href="#pittsburgh-vs-michigan-approach" title="Permalink to this headline">¶</a></h3>
<p>One of the most fundamental distinctions in LSC research is storing knowledge by using two different approaches - <em>Michigan-style</em> or <em>Pittsburgh-style</em>. The first ones were proposed by Holland <span id="id21">[<a class="reference internal" href="../../bibliography.html#id22">2</a>]</span> while the latter one by Kenneth DeJong and his student <span id="id22">[<a class="reference internal" href="../../bibliography.html#id64">56</a>]</span> <span id="id23">[<a class="reference internal" href="../../bibliography.html#id65">57</a>]</span>.</p>
<p>The fundamental discrepancy is the structure of an individual. In Michigan systems, each individual is a classifier; in Pittsburgh, each individual is a set of classifiers - see Figure <a class="reference internal" href="#michigan-pittsburgh-fig"><span class="std std-numref">2.1</span></a>.</p>
<div class="figure align-default" id="michigan-pittsburgh-fig">
<img alt="../../_images/michigan_pittsburgh.png" src="../../_images/michigan_pittsburgh.png" />
<p class="caption"><span class="caption-number">Fig. 2.1 </span><span class="caption-text">Differences between representing knowledge in both Michigan-style and Pittsburgh-style LCS. Figure taken from <span id="id24">[<a class="reference internal" href="../../bibliography.html#id66">58</a>]</span>.</span><a class="headerlink" href="#michigan-pittsburgh-fig" title="Permalink to this image">¶</a></p>
</div>
<p>Thus, the classifiers in Michigan-style LCS are being continuously evaluated and evolved, while in Pittsburgh-style LCS, the same process is much more complicated because the whole population needs to be assessed. Therefore, Michigan-style systems are typically applied in interactive, online learning problems, while Pittsburgh ones are rather suitable for offline learning <span id="id25">[<a class="reference internal" href="../../bibliography.html#id66">58</a>]</span>.</p>
<p>This work focuses solely on the first class of LCS.</p>
</div>
</div>
<div class="section" id="representative-lcs">
<h2>Representative LCS<a class="headerlink" href="#representative-lcs" title="Permalink to this headline">¶</a></h2>
<p>This section describes Michigan-style LCS implementations contributing primarily to the current advancements.</p>
<div class="section" id="cs-1">
<h3>CS-1<a class="headerlink" href="#cs-1" title="Permalink to this headline">¶</a></h3>
<p>Two years after presenting the theoretical model of CS, Holland and Reitman proposed its implementation of CS-1 <span id="id26">[<a class="reference internal" href="../../bibliography.html#id22">2</a>]</span>. The system realized the Darwinian principle of the <em>survival of the fittest</em> <span id="id27">[<a class="reference internal" href="../../bibliography.html#id80">59</a>]</span> <span id="id28">[<a class="reference internal" href="../../bibliography.html#id81">60</a>]</span> and was generating adaptive behaviour by maximizing reinforcement using the bucket brigade algorithm (BBA) <span id="id29">[<a class="reference internal" href="../../bibliography.html#id80">59</a>]</span> <span id="id30">[<a class="reference internal" href="../../bibliography.html#id81">60</a>]</span>.</p>
<p>Some internal mechanisms like the usage of an internal message list (handling all input and output communications between the system and the environment and providing a makeshift memory) or interactions between evolving both single classifier and entire population were considered difficult <span id="id31">[<a class="reference internal" href="../../bibliography.html#id76">61</a>]</span> <span id="id32">[<a class="reference internal" href="../../bibliography.html#id54">47</a>]</span>. Moreover, the obtained results were inconsistent, signifying the need for improvements.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition-steward-wilson admonition">
<p class="admonition-title">Steward Wilson</p>
<img alt="../../_images/steward_wilson.gif" src="../../_images/steward_wilson.gif" />
<p><a class="reference external" href="https://ieeexplore.ieee.org/author/37550361200">Steward Wilson</a> is an Independent Researcher in classifier systems and evolutionary computation.</p>
<p>His PhD thesis investigated what would happen if a child could ask questions and receive excellent spoken answers from a machine that connected him to recordings made by a scientist such as Carl Sagan. The results showed long, thoughtful lines of inquiry for this student-driven learning style.</p>
</div>
</div>
</div>
<div class="section" id="zcs">
<h3>ZCS<a class="headerlink" href="#zcs" title="Permalink to this headline">¶</a></h3>
<p>The <em>Zeroth Level Classifier</em> (ZCS) introduced by Wilson in 1994 <span id="id33">[<a class="reference internal" href="../../bibliography.html#id77">62</a>]</span> encompasses all LCS components while simplifying the CS-1, increasing its understandability and performance. The significant change was the removal of the internal message list (determining the rule’s format entirely by the system interface) alongside with rule-bidding credit assignment (replacing it with BBA/Q-learning algorithm <span id="id34">[<a class="reference internal" href="../../bibliography.html#id78">63</a>]</span>).</p>
<p>Moreover, the classifier fitness was based on the accumulated reward that the agent can get from firing the classifier, giving rise to the <em>“strength-based”</em> family of LCS. As a result, the discovery component eliminates classifiers providing less reward than others from the population.</p>
<p>ZCS achieved similar performance to CS-1, demonstrating that Holland’s idea could work even in a straightforward framework. However, the premature converge onto suboptimal rules before search space can be explored appropriately and a stable population formed led Wilson to consider other ways to achieve this.</p>
</div>
<div class="section" id="xcs">
<span id="section-topics-history-xcs"></span><h3>XCS<a class="headerlink" href="#xcs" title="Permalink to this headline">¶</a></h3>
<p>In 1995 Wilson introduce yet another, groundbreaking modification called the <em>eXtended Classifier System</em> (XCS) <span id="id35">[<a class="reference internal" href="../../bibliography.html#id28">28</a>]</span> <span id="id36">[<a class="reference internal" href="../../bibliography.html#id4">64</a>]</span> <span id="id37">[<a class="reference internal" href="../../bibliography.html#id5">65</a>]</span> <span id="id38">[<a class="reference internal" href="../../bibliography.html#id91">66</a>]</span> noted for being able to reach optimal performance while evolving accurate and maximally general classifiers.</p>
<p>The essential changes include:</p>
<ul class="simple">
<li><p>rule fitness is based on the accuracy of predictions (forming the <em>accuracy-based</em> LCS family),</p></li>
<li><p>replacement of panmictically acting GA with a <em>niche-GA</em>  <span id="id39">[<a class="reference internal" href="../../bibliography.html#id79">67</a>]</span> (applied only in action set <span class="math notranslate nohighlight">\([A]\)</span> instead of globally <span class="math notranslate nohighlight">\([P]\)</span>),</p></li>
<li><p>explicit generalization mechanism (<em>subsumption</em>),</p></li>
<li><p>an adaptation of Q-Learning credit assignment.</p></li>
</ul>
<p>The XCS design drives it to form an all-inclusive and accurate representation of the problem space rather than focusing on higher payoff niches. Auspicious performance results showed that RL <span id="id40">[<a class="reference internal" href="../../bibliography.html#id45">51</a>]</span> and LCS are not only linked but inherently overlapping, redefining LCSs as RL endowed with generalization capabilities <span id="id41">[<a class="reference internal" href="../../bibliography.html#id84">68</a>]</span> <span id="id42">[<a class="reference internal" href="../../bibliography.html#id85">69</a>]</span>. As a result, it becomes the most popular LCS implementation, guiding other system implementations heavily inspired by its architecture.</p>
</div>
<div class="section" id="modern-lcs">
<h3>Modern LCS<a class="headerlink" href="#modern-lcs" title="Permalink to this headline">¶</a></h3>
<p>The latest LCS advancements focus mainly on problems related to knowledge visualization and rules compaction <span id="id43">[<a class="reference internal" href="../../bibliography.html#id120">70</a>]</span>, <span id="id44">[<a class="reference internal" href="../../bibliography.html#id124">71</a>]</span>, learning with incremental data <span id="id45">[<a class="reference internal" href="../../bibliography.html#id121">72</a>]</span> <span id="id46">[<a class="reference internal" href="../../bibliography.html#id123">73</a>]</span>, classifying images using convolutional autoencoders <span id="id47">[<a class="reference internal" href="../../bibliography.html#id122">74</a>]</span> <span id="id48">[<a class="reference internal" href="../../bibliography.html#id123">73</a>]</span> <span id="id49">[<a class="reference internal" href="../../bibliography.html#id126">75</a>]</span>, or dealing with perceptual aliasing environments <span id="id50">[<a class="reference internal" href="../../bibliography.html#id125">76</a>]</span>.</p>
</div>
</div>
<div class="section" id="anticipatory-learning-classifier-systems">
<h2>Anticipatory Learning Classifier Systems<a class="headerlink" href="#anticipatory-learning-classifier-systems" title="Permalink to this headline">¶</a></h2>
<p>The field of cognitive psychology initially guided the investigation about the presence and importance of anticipations. It was proved that “higher” animals form and exploit anticipations while adopting their behaviour in distinct tasks. Wilson noted that when simulating adaptive behaviour, the animats should be endowed with anticipations <span id="id51">[<a class="reference internal" href="../../bibliography.html#id87">77</a>]</span>. In traditional RL, the first approaches manifested in Dyna architecture <span id="id52">[<a class="reference internal" href="../../bibliography.html#id29">53</a>]</span>, but due to the lack of generalization capabilities, its utilization was limited. The Anticipatory Learning Classifier Systems (ALCS) aims to bridge the gap for exploiting the generalization capabilities while including the explicit notion of anticipations.</p>
<div class="section" id="cfcs2">
<h3>CFCS2<a class="headerlink" href="#cfcs2" title="Permalink to this headline">¶</a></h3>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition-latent-learning admonition">
<p class="admonition-title">Latent learning</p>
<p>Learning without explicit reward feedback (e.g. learning a sequence of states based on actions taken and the following expected states).</p>
</div>
</div>
<p>Riolo laid the foundations towards including predictions in 1991 by introducing a modification called CFCS2 <span id="id53">[<a class="reference internal" href="../../bibliography.html#id82">78</a>]</span>. It addressed the task of performing “latent learning” or “lookahead planning” where <em>“actions are based on predictions of future states of the world, using both current information and past experience as embodied in the agent’s internal models of the world”</em> <span id="id54">[<a class="reference internal" href="../../bibliography.html#id83">79</a>]</span>.</p>
<p>CFCS2 used “tags” to specify if a current action posted to a message list refers to actual action or anticipation, claiming a reduction in the learning time for general sequential decision tasks. Riolo was able to show the possibilities of latent learning and lookahead planning, but the implicit formation of anticipations appeared to be misleading. Additionally, the CFCS2 did not achieve any generalization capabilities.</p>
</div>
<div class="section" id="acs">
<h3>ACS<a class="headerlink" href="#acs" title="Permalink to this headline">¶</a></h3>
<p>The first system competent of evolving a maximally generalized, accurate and complete mapping of all possible situation-effect-action triples observable in the environment - the Anticipatory Classifier System (ACS) was introduced by Stolzmann in 1997 <span id="id55">[<a class="reference internal" href="../../bibliography.html#id88">80</a>]</span> <span id="id56">[<a class="reference internal" href="../../bibliography.html#id86">81</a>]</span>.</p>
<p>The rule structure was enhanced with an <em>anticipatory</em> or <em>effect</em> part that explicitly anticipates the effects of an action in a given situation. The effect part could determine which attributes change after executing an action by using a <em>“pass-through”</em> symbol - <span class="math notranslate nohighlight">\(\#\)</span>, which significantly enhances the rule’s interpretability. In order to perform latent learning, forming and refining classifiers, a discovery component - the Anticipatory Learning Process (ALP) was introduced.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition-perceptual-aliasing admonition">
<p class="admonition-title">Perceptual aliasing</p>
<p>Case when same observation is obtained in distinct states requiring different actions.</p>
</div>
</div>
<p>ALP realizes the psychological Hoffmann’s anticipatory behavioral control theory <span id="id57">[<a class="reference internal" href="../../bibliography.html#id92">82</a>]</span> <span id="id58">[<a class="reference internal" href="../../bibliography.html#id89">83</a>]</span> stating that conditional action-effects relations are learned latently using anticipations, which he further refined in <span id="id59">[<a class="reference internal" href="../../bibliography.html#id90">84</a>]</span>. The following points (visualised in Figure <a class="reference internal" href="#abc-fig"><span class="std std-numref">2.2</span></a>) can be distinguished:</p>
<ol class="simple">
<li><p>Any behavioural act or response (<span class="math notranslate nohighlight">\(R\)</span>) is accompanied by anticipation of its effects.</p></li>
<li><p>The anticipations of the effects <span class="math notranslate nohighlight">\(E_{ant}\)</span> are compared with the real effects <span class="math notranslate nohighlight">\(E_{real}\)</span>.</p></li>
<li><p>When the anticipations are correct, the bond between response and anticipation is strengthened and weakened otherwise.</p></li>
<li><p>Behavioural stimuli further differentiate the <span class="math notranslate nohighlight">\(R-E_{ant}\)</span> relations.</p></li>
</ol>
<div class="figure align-default" id="abc-fig">
<img alt="../../_images/abc.png" src="../../_images/abc.png" />
<p class="caption"><span class="caption-number">Fig. 2.2 </span><span class="caption-text">The theory of anticipatory behavioural control. Adapted from <span id="id60">[<a class="reference internal" href="../../bibliography.html#id90">84</a>]</span>.</span><a class="headerlink" href="#abc-fig" title="Permalink to this image">¶</a></p>
</div>
<p>The implementation of this component compares the obtained state <span class="math notranslate nohighlight">\(\sigma_{t+1}\)</span> with the classifier’s anticipation <span class="math notranslate nohighlight">\(\sigma_{t+1}^{ant}\)</span>. Then, the <em>quality</em> parameter of the involved classifier is updated according to four possible scenarios:</p>
<ol class="simple">
<li><p><em>Useless case</em>. After performing an action, no change in perception is perceived from the environment. The classifier’s quality decreases.</p></li>
<li><p><em>Expected case</em>. When the newly observed state matches the classifier prediction. Classifiers’ quality is increased.</p></li>
<li><p><em>Correctable case</em>. When new state <span class="math notranslate nohighlight">\(\sigma(t+1)\)</span> does not match the anticipation of <span class="math notranslate nohighlight">\(cl.E\)</span>. A new classifier with a matching effect part is generated.</p></li>
<li><p><em>Not correctable case</em>. When new state <span class="math notranslate nohighlight">\(\sigma(t+1)\)</span> does not match the anticipation of <span class="math notranslate nohighlight">\(\sigma_{t+1}^{ant}\)</span>, and it is not possible to correct the classifier, then its quality is penalized like in the useless case.</p></li>
</ol>
<p>The classifiers are removed from the population if they became <em>inadequate</em> - the quality metrics fall below a threshold denoted by the <span class="math notranslate nohighlight">\(\theta_i\)</span> parameter.</p>
<p>The proposed architecture was capable of solving multistep problems, planning, speeding up learning or disambiguating perceptual aliasing.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">lcs.agents.acs2</span> <span class="k">as</span> <span class="nn">acs2</span>
<span class="kn">from</span> <span class="nn">lcs.metrics</span> <span class="kn">import</span> <span class="n">population_metrics</span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Tuple</span>

<span class="k">def</span> <span class="nf">maze_metrics</span><span class="p">(</span><span class="n">agent</span><span class="p">,</span> <span class="n">env</span><span class="p">):</span>
    <span class="n">metrics</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">metrics</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">population_metrics</span><span class="p">(</span><span class="n">agent</span><span class="o">.</span><span class="n">population</span><span class="p">,</span> <span class="n">env</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">metrics</span>

<span class="n">acs2_base_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;classifier_length&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="s1">&#39;number_of_possible_actions&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="s1">&#39;biased_exploration&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;metrics_trial_frequency&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;user_metrics_collector_fcn&#39;</span><span class="p">:</span> <span class="n">maze_metrics</span>
<span class="p">}</span>

<span class="k">def</span> <span class="nf">run_acs2_explore_exploit</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">explore_trials</span><span class="p">,</span> <span class="n">exploit_trials</span><span class="p">,</span> <span class="o">**</span><span class="n">config</span><span class="p">):</span>
    <span class="n">cfg</span> <span class="o">=</span> <span class="n">acs2</span><span class="o">.</span><span class="n">Configuration</span><span class="p">(</span><span class="o">**</span><span class="n">config</span><span class="p">)</span>

    <span class="c1"># explore phase</span>
    <span class="n">agent</span> <span class="o">=</span> <span class="n">acs2</span><span class="o">.</span><span class="n">ACS2</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
    <span class="n">metrics_explore</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">explore</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">explore_trials</span><span class="p">)</span>

    <span class="c1"># exploit phase</span>
    <span class="n">agent_exploit</span> <span class="o">=</span> <span class="n">acs2</span><span class="o">.</span><span class="n">ACS2</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">copy</span><span class="p">(</span><span class="n">agent</span><span class="o">.</span><span class="n">population</span><span class="p">))</span>
    <span class="n">metrics_exploit</span> <span class="o">=</span> <span class="n">agent_exploit</span><span class="o">.</span><span class="n">exploit</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">exploit_trials</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">agent</span><span class="p">,</span> <span class="n">metrics_explore</span><span class="p">),</span> <span class="p">(</span><span class="n">agent_exploit</span><span class="p">,</span> <span class="n">metrics_exploit</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">find_best_classifier</span><span class="p">(</span><span class="n">population</span><span class="p">:</span> <span class="n">acs2</span><span class="o">.</span><span class="n">ClassifiersList</span><span class="p">,</span> <span class="n">situation</span><span class="p">:</span> <span class="n">Perception</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">acs2</span><span class="o">.</span><span class="n">Classifier</span><span class="p">]:</span>
    <span class="n">match_set</span> <span class="o">=</span> <span class="n">population</span><span class="o">.</span><span class="n">form_match_set</span><span class="p">(</span><span class="n">situation</span><span class="p">)</span>
    <span class="n">anticipated_change_cls</span> <span class="o">=</span> <span class="p">[</span><span class="n">cl</span> <span class="k">for</span> <span class="n">cl</span> <span class="ow">in</span> <span class="n">match_set</span> <span class="k">if</span> <span class="n">cl</span><span class="o">.</span><span class="n">does_anticipate_change</span><span class="p">()]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">anticipated_change_cls</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">anticipated_change_cls</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">cl</span><span class="p">:</span> <span class="n">cl</span><span class="o">.</span><span class="n">fitness</span><span class="p">)</span>

    <span class="k">return</span> <span class="kc">None</span>

<span class="k">def</span> <span class="nf">build_fitness_and_action_matrices</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">population</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">:</span>
    <span class="n">original</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">maze</span><span class="o">.</span><span class="n">matrix</span>

    <span class="n">fitness</span> <span class="o">=</span> <span class="n">original</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">action</span> <span class="o">=</span> <span class="n">original</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

    <span class="n">action_lookup</span> <span class="o">=</span> <span class="p">{</span>
        <span class="mi">0</span><span class="p">:</span> <span class="sa">u</span><span class="s1">&#39;↑&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="sa">u</span><span class="s1">&#39;↗&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="sa">u</span><span class="s1">&#39;→&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="sa">u</span><span class="s1">&#39;↘&#39;</span><span class="p">,</span>
        <span class="mi">4</span><span class="p">:</span> <span class="sa">u</span><span class="s1">&#39;↓&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="sa">u</span><span class="s1">&#39;↙&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="sa">u</span><span class="s1">&#39;←&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="sa">u</span><span class="s1">&#39;↖&#39;</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">(</span><span class="n">original</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># path</span>
            <span class="n">perception</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">maze</span><span class="o">.</span><span class="n">perception</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="n">best_cl</span> <span class="o">=</span> <span class="n">find_best_classifier</span><span class="p">(</span><span class="n">population</span><span class="p">,</span> <span class="n">perception</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">best_cl</span><span class="p">:</span>
                <span class="n">fitness</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">best_cl</span><span class="o">.</span><span class="n">fitness</span>
                <span class="n">action</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">action_lookup</span><span class="p">[</span><span class="n">best_cl</span><span class="o">.</span><span class="n">action</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fitness</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="n">action</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;?&#39;</span>

        <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># wall</span>
            <span class="n">fitness</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">action</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;\#&#39;</span>

        <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>  <span class="c1"># reward</span>
            <span class="c1"># add 500 to make it more distinguishable</span>
            <span class="n">fitness</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">fitness</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">500</span>
            <span class="n">action</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;R&#39;</span>

    <span class="k">return</span> <span class="n">fitness</span><span class="p">,</span> <span class="n">action</span>

<span class="k">def</span> <span class="nf">plot_policy</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">fitness_matrix</span><span class="p">,</span> <span class="n">action_matrix</span><span class="p">,</span> <span class="n">plot_filename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

    <span class="n">max_x</span><span class="p">,</span> <span class="n">max_y</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">maze</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">shape</span>

    <span class="c1"># Render maze as image</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">fitness_matrix</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_x</span><span class="p">,</span> <span class="n">max_y</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

    <span class="c1"># Add labels to each cell</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">(</span><span class="n">action_matrix</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mf">0.4</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;$</span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;ACS2 policy in Maze5 environment&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_x</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">max_y</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_x</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_y</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">plot_filename</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">plot_filename</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">PLOT_DPI</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>

<span class="nd">@get_from_cache_or_run</span><span class="p">(</span><span class="n">cache_path</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cache_dir</span><span class="si">}</span><span class="s1">/acs2_maze5.dill&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">run_acs2_in_maze5</span><span class="p">():</span>
    <span class="n">env</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s1">&#39;Maze5-v0&#39;</span><span class="p">)</span>
    <span class="n">explore_phase</span><span class="p">,</span> <span class="n">exploit_phase</span> <span class="o">=</span> <span class="n">run_acs2_explore_exploit</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">explore_trials</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">exploit_trials</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="o">**</span><span class="n">acs2_base_params</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">env</span><span class="p">,</span> <span class="n">explore_phase</span><span class="p">,</span> <span class="n">exploit_phase</span>

<span class="c1"># Run computation</span>
<span class="n">env_</span><span class="p">,</span> <span class="n">explore_</span><span class="p">,</span> <span class="n">exploit_</span> <span class="o">=</span> <span class="n">run_acs2_in_maze5</span><span class="p">()</span>

<span class="c1"># Plot the policy</span>
<span class="n">fitness_matrix</span><span class="p">,</span> <span class="n">action_matrix</span> <span class="o">=</span> <span class="n">build_fitness_and_action_matrices</span><span class="p">(</span><span class="n">env_</span><span class="p">,</span> <span class="n">explore_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">population</span><span class="p">)</span>
<span class="n">acs2_policy_fig</span> <span class="o">=</span> <span class="n">plot_policy</span><span class="p">(</span><span class="n">env_</span><span class="p">,</span> <span class="n">fitness_matrix</span><span class="p">,</span> <span class="n">action_matrix</span><span class="p">,</span> <span class="n">plot_filename</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">plot_dir</span><span class="si">}</span><span class="s1">/acs2-maze5-policy.png&#39;</span><span class="p">)</span>

<span class="n">glue</span><span class="p">(</span><span class="s1">&#39;acs2_policy_fig&#39;</span><span class="p">,</span> <span class="n">acs2_policy_fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">glue</span><span class="p">(</span><span class="s1">&#39;acs2_population_size&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">explore_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">population</span><span class="p">),</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
</div>
<div class="section" id="acs2">
<h3>ACS2<a class="headerlink" href="#acs2" title="Permalink to this headline">¶</a></h3>
<p>Later,  in  2002 Martin Butz  <span id="id61">[<a class="reference internal" href="../../bibliography.html#id6">85</a>]</span> <span id="id62">[<a class="reference internal" href="../../bibliography.html#id93">86</a>]</span>  extended ACS by introducing  a system named ACS2.  The  significant  changes  from  the  previous  version include:</p>
<ul class="simple">
<li><p>application of learning component across the whole action set <span class="math notranslate nohighlight">\([A]\)</span> (all classifiers from <span class="math notranslate nohighlight">\([M]\)</span> advocating selected action),</p></li>
<li><p>introduction of GA component,</p></li>
<li><p>refinement of learning component utilizing the Q-learning <span id="id63">[<a class="reference internal" href="../../bibliography.html#id29">53</a>]</span> algorithm,</p></li>
<li><p>condition-action-effect triples that anticipate no change in the environment are explicitly encompassed in population,</p></li>
<li><p>add <em>mark</em> property to classifier, recording the properties in which it did not perform correctly before.</p></li>
</ul>
<p>The ALP process was refined due to its delicate nature. The first improvement relates to the process of improving new classifier generation by covering all possible condition-action-effect triples. The process called <code class="docutils literal notranslate"><span class="pre">COVERING</span></code> is called when there is no classifier in the action set <span class="math notranslate nohighlight">\([A]\)</span> representing the encountered situation. A newly created classifier specifies all changes from the previous situation <span class="math notranslate nohighlight">\(\sigma_{t-1}\)</span> to situation <span class="math notranslate nohighlight">\(\sigma\)</span> in condition and effect part. Second, because the offspring might be introduced by ALP and GA, the insertion process must be cautious. A <em>subsumption</em> operation checks if one classifier is not covered by the other, more general one. For a classifier <span class="math notranslate nohighlight">\(cl_{sub}\)</span> to subsume another classifier <span class="math notranslate nohighlight">\(cl_{tos}\)</span>, the subsumer needs to be experienced, reliable and not marked. Moreover, the subsumer’s condition part needs to be syntactically more general, and the effect part needs to be identical.</p>
<p>The GA algorithm is responsible for generalizing the condition parts. The method starts by determining if the GA should actually take place, controlled by the <span class="math notranslate nohighlight">\(t_{ga}\)</span> time stamp and the actual time <span class="math notranslate nohighlight">\(t\)</span>. If a GA takes place, preferable accurate, over-specified classifiers are selected, mutated and crossed, see <span id="id64">[<a class="reference internal" href="../../bibliography.html#id93">86</a>]</span> for a detailed explanation.</p>
<p>Experiments showed that the genetic generalization process in ACS2 decreased the population size and consequently speed up the computational process.</p>
<p>Figure <a class="reference internal" href="#acs2-policy-fig"><span class="std std-numref">2.3</span></a> demonstrates an example of RL policy generated by a population of <span class="pasted-inline"><code class="output text_plain docutils literal notranslate"><span class="pre">322</span></code></span> classifiers trained over 5000 trials operating in popular Maze5 benchmarking problem. The model knows the consequences of each available action in every possible state; therefore, estimating the fitness value of each classifier can suggest the most promising action. The learning can be still optimized by using cognitive mechanisms like lookahead planning <span id="id65">[<a class="reference internal" href="../../bibliography.html#id83">79</a>]</span>.</p>
<div class="figure align-default" id="acs2-policy-fig">
<div class="cell_output docutils container">
<img alt="../../_images/22_alcs_history_7_0.png" src="../../_images/22_alcs_history_7_0.png" />
</div>
<p class="caption"><span class="caption-number">Fig. 2.3 </span><span class="caption-text">Policy generated by ACS2 in Maze5 environment. The saturation of the red colour reflects the best classifier fitness value. The agent is inserted randomly on the red field in each trial to reach the reward state “R” by executing one of the eight possible actions.</span><a class="headerlink" href="#acs2-policy-fig" title="Permalink to this image">¶</a></p>
</div>
<p>The recent advancements include the integration of the action planning mechanism <span id="id66">[<a class="reference internal" href="../../bibliography.html#id100">87</a>]</span>, PEPACS extension where the concept of <em>Probability-Enhanced-Predictions</em> is used for handling non-deterministic environments <span id="id67">[<a class="reference internal" href="../../bibliography.html#id109">88</a>]</span> or BACS tackling the issue of perceptual aliasing by building <em>Behavioral Sequences</em> <span id="id68">[<a class="reference internal" href="../../bibliography.html#id110">89</a>]</span>.</p>
</div>
<div class="section" id="yacs">
<h3>YACS<a class="headerlink" href="#yacs" title="Permalink to this headline">¶</a></h3>
<p>In the same year, 2002, Gérard introduced a “<em>Yet Another Classifier System</em>” (YACS) <span id="id69">[<a class="reference internal" href="../../bibliography.html#id94">90</a>]</span>. It shares the same C-A-E classifier structure as ACS and ACS2, but the essential conceptual difference is that YACS is designed to decorrelate the acquisition of relevant <span class="math notranslate nohighlight">\(C\)</span> and <span class="math notranslate nohighlight">\(E\)</span> parts by building them independently using a set of heuristics. The latent learning process is designed to set the E parts to perceived changes in the environment and then discover relevant C parts. Moreover, it does not take advantage of genetic generalization mechanisms relying on the discovery process to determine significant attributes correctly. In order to compute the optimal policy YACS memorizes internally every encountered state and uses a simplified variety of value iteration algorithm.</p>
<p>The evaluation was performed only in simple multistep maze environments reaching <em>near optimal</em> solutions. The specialization process in YACS leads to less over-specialization than the corresponding process in ACS but still suffers from the lack of a dedicated generalization mechanism. Additionally, the YACS cannot deal with uncertainty and operate only in Markov and deterministic environments.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">lcs.agents.macs.macs</span> <span class="k">as</span> <span class="nn">macs</span>

<span class="n">maze228_env</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s1">&#39;Maze228-v0&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_calculate_rotating_maze_knowledge</span><span class="p">(</span><span class="n">agent</span><span class="p">:</span> <span class="n">macs</span><span class="o">.</span><span class="n">MACS</span><span class="p">,</span> <span class="n">env</span><span class="p">):</span>
    <span class="n">transitions</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">transitions</span>
    <span class="n">covered_transitions</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">p0</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p1</span> <span class="ow">in</span> <span class="n">transitions</span><span class="p">:</span>
        <span class="n">p0p</span> <span class="o">=</span> <span class="n">Perception</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">p0</span><span class="p">)))</span>
        <span class="n">p1p</span> <span class="o">=</span> <span class="n">Perception</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">p1</span><span class="p">)))</span>
        <span class="n">anticipations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">agent</span><span class="o">.</span><span class="n">get_anticipations</span><span class="p">(</span><span class="n">p0p</span><span class="p">,</span> <span class="n">a</span><span class="p">))</span>

        <span class="c1"># accurate classifiers</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">anticipations</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">anticipations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">p1p</span><span class="p">:</span>
            <span class="n">covered_transitions</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">covered_transitions</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">transitions</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_macs_metrics</span><span class="p">(</span><span class="n">agent</span><span class="p">:</span> <span class="n">macs</span><span class="o">.</span><span class="n">MACS</span><span class="p">,</span> <span class="n">env</span><span class="p">):</span>
    <span class="n">population</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">population</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;pop&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">population</span><span class="p">),</span>
        <span class="s1">&#39;situations&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">agent</span><span class="o">.</span><span class="n">desirability_values</span><span class="p">),</span>
        <span class="s1">&#39;0_cls&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">([</span><span class="n">cl</span> <span class="k">for</span> <span class="n">cl</span> <span class="ow">in</span> <span class="n">population</span> <span class="k">if</span> <span class="n">cl</span><span class="o">.</span><span class="n">action</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">cl</span><span class="o">.</span><span class="n">is_accurate</span><span class="p">]),</span>
        <span class="s1">&#39;1_cls&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">([</span><span class="n">cl</span> <span class="k">for</span> <span class="n">cl</span> <span class="ow">in</span> <span class="n">population</span> <span class="k">if</span> <span class="n">cl</span><span class="o">.</span><span class="n">action</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">cl</span><span class="o">.</span><span class="n">is_accurate</span><span class="p">]),</span>
        <span class="s1">&#39;2_cls&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">([</span><span class="n">cl</span> <span class="k">for</span> <span class="n">cl</span> <span class="ow">in</span> <span class="n">population</span> <span class="k">if</span> <span class="n">cl</span><span class="o">.</span><span class="n">action</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">cl</span><span class="o">.</span><span class="n">is_accurate</span><span class="p">]),</span>
        <span class="s1">&#39;knowledge&#39;</span><span class="p">:</span> <span class="n">_calculate_rotating_maze_knowledge</span><span class="p">(</span><span class="n">agent</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
    <span class="p">}</span>

<span class="nd">@get_from_cache_or_run</span><span class="p">(</span><span class="n">cache_path</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cache_dir</span><span class="si">}</span><span class="s1">/macs_maze228.dill&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">run_macs_in_maze228</span><span class="p">(</span><span class="n">env</span><span class="p">):</span>
    <span class="n">cfg</span> <span class="o">=</span> <span class="n">macs</span><span class="o">.</span><span class="n">Configuration</span><span class="p">(</span><span class="n">classifier_length</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span>
                        <span class="n">number_of_possible_actions</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                        <span class="n">feature_possible_values</span><span class="o">=</span><span class="p">[{</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;9&#39;</span><span class="p">}]</span> <span class="o">*</span> <span class="mi">8</span> <span class="o">+</span> <span class="p">[{</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;9&#39;</span><span class="p">}],</span>
                        <span class="n">estimate_expected_improvements</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">metrics_trial_frequency</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                        <span class="n">user_metrics_collector_fcn</span><span class="o">=</span><span class="n">_macs_metrics</span><span class="p">)</span>

    <span class="n">agent</span> <span class="o">=</span> <span class="n">macs</span><span class="o">.</span><span class="n">MACS</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
    <span class="n">metrics</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">explore</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">agent</span><span class="p">,</span> <span class="n">metrics</span>

<span class="c1"># run computations</span>
<span class="n">macs_agent</span><span class="p">,</span> <span class="n">macs_metrics</span> <span class="o">=</span> <span class="n">run_macs_in_maze228</span><span class="p">(</span><span class="n">maze228_env</span><span class="p">)</span>

<span class="c1"># visualization</span>
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">129</span><span class="p">)</span>  <span class="c1"># found experimentally</span>
<span class="n">maze228_env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="n">left_from_reward</span> <span class="o">=</span> <span class="n">maze228_env</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">maze</span><span class="o">.</span><span class="n">perception</span><span class="p">()</span>

<span class="n">glue</span><span class="p">(</span><span class="s1">&#39;maze228_perception&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">left_from_reward</span><span class="p">),</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">glue</span><span class="p">(</span><span class="s1">&#39;macs_maze228_population&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">macs_agent</span><span class="o">.</span><span class="n">population</span><span class="p">),</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
</div>
<div class="section" id="macs">
<h3>MACS<a class="headerlink" href="#macs" title="Permalink to this headline">¶</a></h3>
<p>Knowing certain limitations of ACS and YACS in 2005, Gérard proposed a <em>Modular Anticipatory Classifier System</em> (MACS) <span id="id70">[<a class="reference internal" href="../../bibliography.html#id95">91</a>]</span>. He realised that specific problems would be better approached with a different representation of the rule formalism. While in ACS and YACS, generalisation and selective attention are afforded by the joint use of <em>don’t care</em> and <em>pass-through</em> symbols, it can detect if a particular attribute is changing or not. The efficient representation of regularities across different attributes is impossible because each situation is considered an unsecable whole.</p>
<p>The particularity of such regularity is that the new value of an attribute depends on the previous value of another one. To overcome this problem, the <em>pass-through</em> symbol (#) in the expected situation <span class="math notranslate nohighlight">\(E\)</span> was replaced with the <em>don’t know</em> symbol (?). This formalism allows decorrelating the attributes from <span class="math notranslate nohighlight">\(E\)</span>, where previously, the new value of an attribute may only depend upon the previous value of the same attribute.</p>
<p>This modification resulted in specific rule representation and modified architecture for latent learning. Each time a match-set <span class="math notranslate nohighlight">\([M]\)</span> is built a rule for each attribute change is picked, and then the final anticipation is combined.</p>
<p>The example of differences between rules is illustrated using the Maze228 problem <span id="id71">[<a class="reference internal" href="../../bibliography.html#id95">91</a>]</span>. The agent’s goal is to obtain the final reward. It perceives its surroundings (wall - <code class="docutils literal notranslate"><span class="pre">1</span></code>, path - <code class="docutils literal notranslate"><span class="pre">0</span></code> or reward - <code class="docutils literal notranslate"><span class="pre">9</span></code>) using the clockwise vector of nine attributes and can execute three actions - step ahead - <code class="docutils literal notranslate"><span class="pre">0</span></code>, rotate left - <code class="docutils literal notranslate"><span class="pre">1</span></code> or rotate right - <code class="docutils literal notranslate"><span class="pre">2</span></code>. Assume that the current situation is depicted on the plot below, where the agent is located on the left of the reward, and its actual perception is <span class="pasted-inline"><code class="output text_plain docutils literal notranslate"><span class="pre">'009111000'</span></code></span>.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">maze228_env</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-Black">■</span>
<span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-White">□</span> <span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-White">□</span> <span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-White">□</span> <span class=" -Color -Color-Black">■</span>
<span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-White">□</span> <span class=" -Color -Color-White">□</span> <span class=" -Color -Color-White">□</span> <span class=" -Color -Color-White">□</span> <span class=" -Color -Color-White">□</span> <span class=" -Color -Color-Black">■</span>
<span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-White">□</span> <span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-White">□</span> <span class=" -Color -Color-White">□</span> <span class=" -Color -Color-Black">■</span>
<span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-White">□</span> <span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-White">□</span> <span class=" -Color -Color-White">□</span> <span class=" -Color -Color-White">□</span> <span class=" -Color -Color-Black">■</span>
<span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-White">□</span> <span class=" -Color -Color-White">□</span> <span class=" -Color -Color-White">□</span> <span class=" -Color -Color-Red">A</span> <span class=" -Color -Color-Yellow">$</span> <span class=" -Color -Color-Black">■</span>
<span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-Black">■</span> <span class=" -Color -Color-Black">■</span>
</pre></div>
</div>
</div>
</div>
<p>After training, MACS represents complete knowledge about this environment using <span class="pasted-inline"><code class="output text_plain docutils literal notranslate"><span class="pre">211</span></code></span> classifiers. The final anticipation is obtained after combining particular classifiers selected for each action. This process for the examined environmental state is shown in the table below.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">macs_agent</span><span class="o">.</span><span class="n">population</span><span class="o">.</span><span class="n">form_match_set</span><span class="p">(</span><span class="n">left_from_reward</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">cl</span><span class="p">:</span> <span class="n">cl</span><span class="o">.</span><span class="n">action</span><span class="p">)</span>
<span class="n">macs_knowledge</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">action</span><span class="p">,</span> <span class="n">group_cl</span> <span class="ow">in</span> <span class="n">groupby</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">cl</span><span class="p">:</span> <span class="n">cl</span><span class="o">.</span><span class="n">action</span><span class="p">):</span>
    <span class="n">macs_knowledge</span><span class="p">[</span><span class="n">action</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">macs_knowledge</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="s1">&#39;anticipation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&lt;code&gt;</span><span class="si">{</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">macs_agent</span><span class="o">.</span><span class="n">get_anticipations</span><span class="p">(</span><span class="n">left_from_reward</span><span class="p">,</span> <span class="n">action</span><span class="p">)][</span><span class="mi">0</span><span class="p">])</span><span class="si">}</span><span class="s1">&lt;/code&gt;&#39;</span>
    <span class="n">macs_knowledge</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="s1">&#39;classifiers&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">cl</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">group_cl</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">cl</span><span class="p">:</span> <span class="n">cl</span><span class="o">.</span><span class="n">effect</span><span class="p">):</span>
        <span class="n">macs_knowledge</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="s1">&#39;classifiers&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&lt;code&gt;</span><span class="si">{</span><span class="n">cl</span><span class="o">.</span><span class="n">condition</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">cl</span><span class="o">.</span><span class="n">action</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">cl</span><span class="o">.</span><span class="n">effect</span><span class="si">}</span><span class="s1">&lt;/code&gt;&#39;</span><span class="p">)</span>

<span class="c1"># prepare table</span>
<span class="n">macs_table_data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">&#39;&lt;b&gt;classifiers&lt;/b&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;br/&gt;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">macs_knowledge</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;classifiers&#39;</span><span class="p">]),</span> <span class="s1">&#39;&lt;br/&gt;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">macs_knowledge</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;classifiers&#39;</span><span class="p">]),</span> <span class="s1">&#39;&lt;br/&gt;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">macs_knowledge</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;classifiers&#39;</span><span class="p">])],</span>
    <span class="p">[</span><span class="s1">&#39;&lt;b&gt;anticipation&lt;/b&gt;&#39;</span><span class="p">,</span> <span class="n">macs_knowledge</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;anticipation&#39;</span><span class="p">],</span> <span class="n">macs_knowledge</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;anticipation&#39;</span><span class="p">],</span> <span class="n">macs_knowledge</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;anticipation&#39;</span><span class="p">]],</span>
<span class="p">]</span>

<span class="n">macs_table</span> <span class="o">=</span> <span class="n">tabulate</span><span class="p">(</span><span class="n">macs_table_data</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Step ahead&#39;</span><span class="p">,</span> <span class="s1">&#39;Rotate left&#39;</span><span class="p">,</span> <span class="s1">&#39;Rotate right&#39;</span><span class="p">],</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;unsafehtml&quot;</span><span class="p">,</span> <span class="n">stralign</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="n">macs_table</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<thead>
<tr><th style="text-align: right;">                   </th><th style="text-align: right;">                                                                                                                                                                                                                                                                                                                                                                                                                              Step ahead</th><th style="text-align: right;">                                                                                                                                                                                                                                                                                                                                               Rotate left</th><th style="text-align: right;">                                                                                                                                                                                                                                                                                                                                              Rotate right</th></tr>
</thead>
<tbody>
<tr><td style="text-align: right;"> <b>classifiers</b></td><td style="text-align: right;"><code>0#9###### 0 0????????</code><br/><code>#0###10## 0 ?0???????</code><br/><code>0#9##1### 0 ?0???????</code><br/><code>#0####### 0 ??0??????</code><br/><code>0#9###### 0 ???9?????</code><br/><code>0######## 0 ????0????</code><br/><code>0#####0## 0 ?????0???</code><br/><code>#######0# 0 ??????0??</code><br/><code>##9###### 0 ??????0??</code><br/><code>##91#10## 0 ???????1?</code><br/><code>0######## 0 ????????0</code></td><td style="text-align: right;"><code>######0## 1 0????????</code><br/><code>#######0# 1 ?0???????</code><br/><code>0######## 1 ??0??????</code><br/><code>#0####### 1 ???0?????</code><br/><code>##9###### 1 ????9????</code><br/><code>###1##### 1 ?????1???</code><br/><code>####1#### 1 ??????1??</code><br/><code>#####1### 1 ???????1?</code><br/><code>######### 1 ????????0</code></td><td style="text-align: right;"><code>##9###### 2 9????????</code><br/><code>###1##### 2 ?1???????</code><br/><code>####1#### 2 ??1??????</code><br/><code>#####1### 2 ???1?????</code><br/><code>######0## 2 ????0????</code><br/><code>#######0# 2 ?????0???</code><br/><code>0######## 2 ??????0??</code><br/><code>#0####### 2 ???????0?</code><br/><code>######### 2 ????????0</code></td></tr>
<tr><td style="text-align: right;"><b>anticipation</b></td><td style="text-align: right;">                                                                                                                                                                                                                                                                                                                                                                                                                  <code>000900010</code></td><td style="text-align: right;">                                                                                                                                                                                                                                                                                                                                    <code>000091110</code></td><td style="text-align: right;">                                                                                                                                                                                                                                                                                                                                    <code>911100000</code></td></tr>
</tbody>
</table></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">_acs2_metrics</span><span class="p">(</span><span class="n">agent</span><span class="p">:</span> <span class="n">acs2</span><span class="o">.</span><span class="n">ACS2</span><span class="p">,</span> <span class="n">env</span><span class="p">):</span>
    <span class="n">population</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">population</span>
    <span class="n">reliable</span> <span class="o">=</span> <span class="p">[</span><span class="n">cl</span> <span class="k">for</span> <span class="n">cl</span> <span class="ow">in</span> <span class="n">population</span> <span class="k">if</span> <span class="n">cl</span><span class="o">.</span><span class="n">is_reliable</span><span class="p">()]</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;pop&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">population</span><span class="p">),</span>
        <span class="s1">&#39;rel&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">reliable</span><span class="p">)</span>
    <span class="p">}</span>

<span class="nd">@get_from_cache_or_run</span><span class="p">(</span><span class="n">cache_path</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cache_dir</span><span class="si">}</span><span class="s1">/acs2_maze228.dill&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">run_acs2_in_maze228</span><span class="p">(</span><span class="n">env</span><span class="p">):</span>
    <span class="n">cfg</span> <span class="o">=</span> <span class="n">acs2</span><span class="o">.</span><span class="n">Configuration</span><span class="p">(</span><span class="n">classifier_length</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span>
                        <span class="n">number_of_possible_actions</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                        <span class="n">metrics_trial_frequency</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                        <span class="n">user_metrics_collector_fcn</span><span class="o">=</span><span class="n">_acs2_metrics</span><span class="p">,</span>
                        <span class="n">do_ga</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">agent</span> <span class="o">=</span> <span class="n">acs2</span><span class="o">.</span><span class="n">ACS2</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
    <span class="n">metrics</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">explore</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">agent</span><span class="p">,</span> <span class="n">metrics</span>

<span class="n">acs2_agent</span><span class="p">,</span> <span class="n">acs2_metrics</span> <span class="o">=</span> <span class="n">run_acs2_in_maze228</span><span class="p">(</span><span class="n">maze228_env</span><span class="p">)</span>

<span class="n">reliable_classifiers</span> <span class="o">=</span> <span class="p">[</span><span class="n">cl</span> <span class="k">for</span> <span class="n">cl</span> <span class="ow">in</span> <span class="n">acs2_agent</span><span class="o">.</span><span class="n">population</span> <span class="k">if</span> <span class="n">cl</span><span class="o">.</span><span class="n">is_reliable</span><span class="p">()]</span>

<span class="n">glue</span><span class="p">(</span><span class="s1">&#39;acs2_maze228_population&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">reliable_classifiers</span><span class="p">),</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>On the other side, the ACS2 creates a much larger population of <span class="pasted-inline"><code class="output text_plain docutils literal notranslate"><span class="pre">402</span></code></span> reliable classifiers. There is a single classifier describing the change of multiple attributes for each action. The anticipation in both cases is the same, but due to the specific nature of this problem, MACS results in an overall more compact internal model of the environment.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">acs2_knowledge</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">cl</span> <span class="ow">in</span> <span class="n">acs2_agent</span><span class="o">.</span><span class="n">population</span><span class="o">.</span><span class="n">form_match_set</span><span class="p">(</span><span class="n">left_from_reward</span><span class="p">):</span>
    <span class="n">acs2_knowledge</span><span class="p">[</span><span class="n">cl</span><span class="o">.</span><span class="n">action</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">acs2_knowledge</span><span class="p">[</span><span class="n">cl</span><span class="o">.</span><span class="n">action</span><span class="p">][</span><span class="s1">&#39;classifiers&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">acs2_knowledge</span><span class="p">[</span><span class="n">cl</span><span class="o">.</span><span class="n">action</span><span class="p">][</span><span class="s1">&#39;anticipation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&lt;code&gt;</span><span class="si">{</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cl</span><span class="o">.</span><span class="n">get_best_anticipation</span><span class="p">(</span><span class="n">left_from_reward</span><span class="p">))</span><span class="si">}</span><span class="s1">&lt;/code&gt;&#39;</span>

    <span class="k">if</span> <span class="n">cl</span><span class="o">.</span><span class="n">is_reliable</span><span class="p">():</span>
        <span class="n">acs2_knowledge</span><span class="p">[</span><span class="n">cl</span><span class="o">.</span><span class="n">action</span><span class="p">][</span><span class="s1">&#39;classifiers&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&lt;code&gt;</span><span class="si">{</span><span class="n">cl</span><span class="o">.</span><span class="n">condition</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">cl</span><span class="o">.</span><span class="n">action</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">cl</span><span class="o">.</span><span class="n">effect</span><span class="si">}</span><span class="s1">&lt;/code&gt;&#39;</span><span class="p">)</span>


<span class="c1"># prepare table</span>
<span class="n">acs2_table_data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">&#39;&lt;b&gt;classifiers&lt;/b&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;br/&gt;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">acs2_knowledge</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;classifiers&#39;</span><span class="p">]),</span> <span class="s1">&#39;&lt;br/&gt;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">acs2_knowledge</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;classifiers&#39;</span><span class="p">]),</span> <span class="s1">&#39;&lt;br/&gt;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">acs2_knowledge</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;classifiers&#39;</span><span class="p">])],</span>
    <span class="p">[</span><span class="s1">&#39;&lt;b&gt;anticipation&lt;/b&gt;&#39;</span><span class="p">,</span> <span class="n">acs2_knowledge</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;anticipation&#39;</span><span class="p">],</span> <span class="n">acs2_knowledge</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;anticipation&#39;</span><span class="p">],</span> <span class="n">acs2_knowledge</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;anticipation&#39;</span><span class="p">]],</span>
<span class="p">]</span>

<span class="n">acs2_table</span> <span class="o">=</span> <span class="n">tabulate</span><span class="p">(</span><span class="n">acs2_table_data</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Step ahead&#39;</span><span class="p">,</span> <span class="s1">&#39;Rotate left&#39;</span><span class="p">,</span> <span class="s1">&#39;Rotate right&#39;</span><span class="p">],</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;unsafehtml&quot;</span><span class="p">,</span> <span class="n">stralign</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="n">acs2_table</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<thead>
<tr><th style="text-align: right;">                   </th><th style="text-align: right;">                        Step ahead</th><th style="text-align: right;">                       Rotate left</th><th style="text-align: right;">                      Rotate right</th></tr>
</thead>
<tbody>
<tr><td style="text-align: right;"> <b>classifiers</b></td><td style="text-align: right;"><code>##9111#0# 0 ##0900#1#</code></td><td style="text-align: right;"><code>##911#00# 1 ##009#11#</code></td><td style="text-align: right;"><code>009#11### 2 911#00###</code></td></tr>
<tr><td style="text-align: right;"><b>anticipation</b></td><td style="text-align: right;">            <code>000900010</code></td><td style="text-align: right;">            <code>000091110</code></td><td style="text-align: right;">            <code>911100000</code></td></tr>
</tbody>
</table></div></div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapters/2_selected_topics"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="21_introduction.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">2. </span>Selected topics of Learning Classifier Systems</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="23_real_value_challenge.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">2.2. </span>Real-valued signal challenge</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Norbert Kozłowski<br/>
    
        &copy; Copyright 2022.<br/>
      <div class="extra_footer">
        <div>
  <p><a href="https://wit.pwr.edu.pl/en/">Faculty of Computer Science and Telecommunications</a> - <a href="https://dce.pwr.edu.pl/">Department of Computer Engineering</a></p>
  <p xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/"><a property="dct:title" rel="cc:attributionURL" href="https://khozzy.github.io/phd">Real-valued Anticipatory Classifier System</a> by <span property="cc:attributionName">Norbert Kozlowski</span> is licensed under <a href="http://creativecommons.org/licenses/by/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">CC BY 4.0<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1"></a></p>
</div> 

      </div>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>